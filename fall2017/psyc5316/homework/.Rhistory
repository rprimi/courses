lognormalFit(104)
lognormalFit(105)
lognormalFit(106)
lognormalFit(107)
lognormalFit(108)
lognormalFit(109)
lognormalFit(110)
lognormalFit(111)
lognormalFit(112)
lognormalFit(113)
lognormalFit(114)
lognormalFit(115)
lognormalFit(116)
lognormalFit(117)
lognormalFit(118)
lognormalFit(119)
lognormalFit(120)
lognormalFit(121)
lognormalFit(122)
lognormalFit(123)
lognormalFit(124)
lognormalFit(125)
weibullFit(122)
compareFits <- function(subj}{
RTs <- dataTrue %>%
filter(subject_nr==subj) %>%
select(rt)
initsWeibull <- c(min(RTs), 1, 1) #shift, shape, scale
paramsWeibull <- optim(initsWeibull, nll.wei, dat=RTs$rt)
initsLog <- c(0, 5, 1)
paramsLog <- optim(initsLog, nll.lnorm, dat=RTs$rt)
x <- seq(0,3000,1)
plot(density(RTs$rt),lwd=2,xlab="RT (msec)",main="")
lines(x,dlnorm(x-paramsLog$par[1], meanlog = paramsLog$par[2], sdlog =paramsLog$par[3]),lty=2,lwd=2)
lines(x,dweibull(x-paramsWeibull$par[1], shape = paramsWeibull$par[2], scale=paramsWeibull$par[3]),lty=3,lwd=2)
}
compareFits <- function(subj){
RTs <- dataTrue %>%
filter(subject_nr==subj) %>%
select(rt)
initsWeibull <- c(min(RTs), 1, 1) #shift, shape, scale
paramsWeibull <- optim(initsWeibull, nll.wei, dat=RTs$rt)
initsLog <- c(0, 5, 1)
paramsLog <- optim(initsLog, nll.lnorm, dat=RTs$rt)
x <- seq(0,3000,1)
plot(density(RTs$rt),lwd=2,xlab="RT (msec)",main="")
lines(x,dlnorm(x-paramsLog$par[1], meanlog = paramsLog$par[2], sdlog =paramsLog$par[3]),lty=2,lwd=2)
lines(x,dweibull(x-paramsWeibull$par[1], shape = paramsWeibull$par[2], scale=paramsWeibull$par[3]),lty=3,lwd=2)
}
compareFits(101)
compareFits <- function(subj){
RTs <- dataTrue %>%
filter(subject_nr==subj) %>%
select(rt)
initsWeibull <- c(min(RTs), 1, 1) #shift, shape, scale
paramsWeibull <- optim(initsWeibull, nll.wei, dat=RTs$rt)
initsLog <- c(0, 5, 1)
paramsLog <- optim(initsLog, nll.lnorm, dat=RTs$rt)
x <- seq(0,3000,1)
plot(density(RTs$rt),lwd=2,xlab="RT (msec)",main="")
lines(x,dlnorm(x-paramsLog$par[1], meanlog = paramsLog$par[2], sdlog =paramsLog$par[3]),lty=2,lwd=2)
lines(x,dweibull(x-paramsWeibull$par[1], shape = paramsWeibull$par[2], scale=paramsWeibull$par[3]),lty=3,lwd=2)
legend(2500,0.001,legend=c("lognormal","Weibull"),lty=2:3)
}
compareFits(101)
compareFits(102)
compareFits(103)
compareFits <- function(subj){
RTs <- dataTrue %>%
filter(subject_nr==subj) %>%
select(rt)
initsWeibull <- c(min(RTs), 1, 1) #shift, shape, scale
paramsWeibull <- optim(initsWeibull, nll.wei, dat=RTs$rt)
initsLog <- c(0, 5, 1)
paramsLog <- optim(initsLog, nll.lnorm, dat=RTs$rt)
x <- seq(0,3000,1)
plot(density(RTs$rt),lwd=2,xlab="RT (msec)",main="")
lines(x,dlnorm(x-paramsLog$par[1], meanlog = paramsLog$par[2], sdlog =paramsLog$par[3]),lty=2,lwd=2)
lines(x,dweibull(x-paramsWeibull$par[1], shape = paramsWeibull$par[2], scale=paramsWeibull$par[3]),lty=3,lwd=2)
legend(max(RTs)-500,0.001,legend=c("lognormal","Weibull"),lty=2:3)
}
compareFits(103)
compareFits(101)
density(RTs$rt)
max(density(RTs$rt))
obj <- density(RTs$rt)
ls(obj)
obj$y
max(obj$y)
compareFits <- function(subj){
RTs <- dataTrue %>%
filter(subject_nr==subj) %>%
select(rt)
initsWeibull <- c(min(RTs), 1, 1) #shift, shape, scale
paramsWeibull <- optim(initsWeibull, nll.wei, dat=RTs$rt)
initsLog <- c(0, 5, 1)
paramsLog <- optim(initsLog, nll.lnorm, dat=RTs$rt)
x <- seq(0,3000,1)
plot(density(RTs$rt),lwd=2,xlab="RT (msec)",main="")
lines(x,dlnorm(x-paramsLog$par[1], meanlog = paramsLog$par[2], sdlog =paramsLog$par[3]),lty=2,lwd=2)
lines(x,dweibull(x-paramsWeibull$par[1], shape = paramsWeibull$par[2], scale=paramsWeibull$par[3]),lty=3,lwd=2)
legend(max(RTs)-500,max(density(RTs$rt)$y),legend=c("lognormal","Weibull"),lty=2:3)
}
compareFits(101)
compareFits(102)
compareFits(103)
compareFits(104)
compareFits(105)
compareFits(106)
compareFits(107)
compareFits(108)
?optim
dwald <- function(x,lambda,phi){
sqrt(lambda/(2*pi))*x^(-1.5)*exp(-(x*phi-lambda)^2/(2*lambda*x))
}
nll.wald <- function(par,dat){
return(-sum(log(dwald(dat-par[1],lambda=par[2],phi=par[3]))))
}
plot(x,dwald(x-500,1,1))
plot(x,dwald(x-500,20,1))
plot(x,dwald(x-500,20,20))
plot(x,dwald(x-500,50,20))
plot(x,dwald(x-500,50,20),type="l")
plot(x,dwald(x-500,50,3),type="l")
plot(x,dwald(x-500,20,3),type="l")
plot(x,dwald(x-500,20,2),type="l")
plot(x,dwald(x-500,100,2),type="l")
plot(x,dwald(x-500,200,2),type="l")
plot(x,dwald(x-500,200,30),type="l")
plot(x,dwald(x-500,200,1),type="l")
plot(x,dwald(x-500,200,0.2),type="l")
nll.wald(c(0,100,1),RTs$rt)
waldFit <- function(subj){
RTs <- dataTrue %>%
filter(subject_nr==subj) %>%
select(rt)
inits <- c(0,100,1)
params <- optim(inits,nll.wald, dat=RTs$rt)
x <- seq(0,3000,1)
plot(density(RTs$rt),lwd=2,xlab="RT (msec)",main="")
lines(x,dwald(x-params$par[1], lambda=params$par[2], phi=params$par[3]),lty=2,lwd=2)
}
waldFit(101)
waldFit(102)
waldFit(103)
waldFit(104)
waldFit(105)
waldFit(106)
waldFit(107)
waldFit(108)
waldFit(109)
waldFit(110)
waldFit(111)
waldFit(112)
waldFit(113)
waldFit(114)
waldFit(115)
waldFit(116)
waldFit(117)
nll.wald(c(0,100,1),RTs$rt)
optim(c(0,100,1),nll.wald,dat=RTs$rt)
?optim
waldFit <- function(subj){
RTs <- dataTrue %>%
filter(subject_nr==subj) %>%
select(rt)
inits <- c(0,100,1)
params <- optim(inits,nll.wald, dat=RTs$rt)
aic <- 2*params$value+2*3
x <- seq(0,3000,1)
plot(density(RTs$rt),lwd=2,xlab="RT (msec)",main="")
lines(x,dwald(x-params$par[1], lambda=params$par[2], phi=params$par[3]),lty=2,lwd=2)
text(2000,0.001,expression(paste("AIC = ",aic)))
}
waldFit(117)
text(2000,0.001,"AIC")
text(2000,0.001,paste("AIC",AIC()))
waldFit <- function(subj){
RTs <- dataTrue %>%
filter(subject_nr==subj) %>%
select(rt)
inits <- c(0,100,1)
params <- optim(inits,nll.wald, dat=RTs$rt)
aic <- 2*params$value+2*3
x <- seq(0,3000,1)
plot(density(RTs$rt),lwd=2,xlab="RT (msec)",main="")
lines(x,dwald(x-params$par[1], lambda=params$par[2], phi=params$par[3]),lty=2,lwd=2)
text(2000,0.001,paste("AIC = ", aic))
}
waldFit(117)
waldFit(115)
waldFit(111)
waldFit(110)
waldFit(101)
waldFit(102)
waldFit(103)
waldFit <- function(subj){
RTs <- dataTrue %>%
filter(subject_nr==subj) %>%
select(rt)
inits <- c(0,100,1)
params <- optim(inits,nll.wald, dat=RTs$rt)
aic <- 2*params$value+2*length(params$par)
x <- seq(0,3000,1)
plot(density(RTs$rt),lwd=2,xlab="RT (msec)",main="")
lines(x,dwald(x-params$par[1], lambda=params$par[2], phi=params$par[3]),lty=2,lwd=2)
text(2000,0.001,paste("AIC = ", aic))
}
waldFit(103)
waldFit(102)
waldFit <- function(subj){
RTs <- dataTrue %>%
filter(subject_nr==subj) %>%
select(rt)
inits <- c(0,100,1)
params <- optim(inits,nll.wald, dat=RTs$rt)
aic <- 2*params$value+2*length(params$par)
x <- seq(0,3000,1)
plot(density(RTs$rt),lwd=2,xlab="RT (msec)",main="")
lines(x,dwald(x-params$par[1], lambda=params$par[2], phi=params$par[3]),lty=2,lwd=2)
text(max(RTs)-500,max(density(RTs$rt)$y),paste("AIC = ", aic))
}
waldFit(102)
waldFit <- function(subj){
RTs <- dataTrue %>%
filter(subject_nr==subj) %>%
select(rt)
inits <- c(0,100,1)
params <- optim(inits,nll.wald, dat=RTs$rt)
aic <- 2*params$value+2*length(params$par)
x <- seq(0,3000,1)
plot(density(RTs$rt),lwd=2,xlab="RT (msec)",main="")
lines(x,dwald(x-params$par[1], lambda=params$par[2], phi=params$par[3]),lty=2,lwd=2)
text(max(RTs)-500,0.6*max(density(RTs$rt)$y),paste("AIC = ", aic))
}
waldFit(102)
weibullFit <- function(subj){
RTs <- dataTrue %>%
filter(subject_nr==subj) %>%
select(rt)
inits <- c(min(RTs), 1, 1) #shift, shape, scale
params <- optim(inits, nll.wei, dat=RTs$rt)
aic <- 2*params$value+2*length(params$par)
x <- seq(0,3000,1)
plot(density(RTs$rt),lwd=2,xlab="RT (msec)",main="")
lines(x,dweibull(x-params$par[1], shape = params$par[2], scale=params$par[3]),lty=2,lwd=2)
text(max(RTs)-500,0.6*max(density(RTs$rt)$y),paste("AIC = ", aic))
}
weibullFit(102)
lognormalFit <- function(subj){
RTs <- dataTrue %>%
filter(subject_nr==subj) %>%
select(rt)
inits <- c(0, 5, 1)
params <- optim(inits, nll.lnorm, dat=RTs$rt)
aic <- 2*params$value+2*length(params$par)
x <- seq(0,3000,1)
plot(density(RTs$rt),lwd=2,xlab="RT (msec)",main="")
lines(x,dlnorm(x-params$par[1], meanlog = params$par[2], sdlog =params$par[3]),lty=2,lwd=2)
text(max(RTs)-500,0.6*max(density(RTs$rt)$y),paste("AIC = ", aic))
}
lognormalFit(102)
par(mfrow=c(3,1))
weibullFit(101)
lognormalFit(101)
waldFit(101)
par(mfrow=c(1,3))
weibullFit(101)
lognormalFit(101)
waldFit(101)
par(mfrow=c(3,1))
weibullFit(101)
lognormalFit(101)
waldFit(101)
par(mfrow=c(3,1))
weibullFit(102)
lognormalFit(102)
waldFit(102)
par(mfrow=c(3,1))
weibullFit(103)
lognormalFit(103)
waldFit(103)
par(mfrow=c(3,1))
weibullFit(104)
lognormalFit(104)
waldFit(104)
par(mfrow=c(3,1))
weibullFit(105)
lognormalFit(105)
waldFit(105)
dbinom(x=8, size=10, prob=0.5)
dbinom(x=8, size=10, prob=0.5) +
dbinom(x=9, size=10, prob=0.5)+
dbinom(x=10, size=10, prob=0.5)
dbinom(x=9, size=10, prob=0.5)+
dbinom(x=10, size=10, prob=0.5)
pbinom(9,size=10,prob=0.5)
1-pbinom(9,size=10,prob=0.5)
?dbinom
1-pbinom(8,size=10,prob=0.5)
?dnorm
x=seq(0,200,0.1)
plot(x,dnorm(x,100,15),type="l")
lines(x,dnorm(x,100,20), lty=2)
lines(x,dnorm(x,100,30), lty=2)
pnorm(0)
pnorm(200,230,20)
pnorm(240,230,20)
1-pnorm(240,230,20)
pnorm(250,230,20)-pnorm(210,230,20)
?qnorm
qnorm(0.95, mean=230, sd=20)
qnorm(c(0.025,0.075), mean=230,sd=20)
qnorm(c(0.025,0.975), mean=230,sd=20)
x = c(1,2,3,4,5)
p = c(0.15, 0.2, 0.3, 0.2, 0.15)
sum(x*p)
sum((x-3)^2*p)
barplot(p)
p = c(0.2, 0.2, 0.3, 0.2, 0.10)
barplot(p)
p = c(0.15, 0.25, 0.3, 0.2, 0.10)
barplot(p)
sum(x*p)
sum((x-3)^2*p)
2.85-1.45
2.85+1.45
x=0:30
barplot(dbinom(x,30,0.3))
barplot(dbinom(x,30,0.3),names.arg=x)
dbinom(5,5,0.3)
x = 1:20
barplot(dbinom(x, size = 20, prob=0.7))
barplot(dbinom(x, size = 20, prob=0.7),names.arg = x, xlab="x", ylab="p(x)")
y = dbinom(x, size = 20, prob=0.7)
barplot(y,names.arg = x, xlab="x", ylab="p(x)")
y = dbinom(x, size = 20, prob=0.7)
barplot(y,names.arg = x, xlab="x", ylab="p(x)")
sum(y)
sum(y)
theta = seq(from=0, to=1, by=0.01)
y = dbinom(12, size=20, prob=theta)
plot(theta,y)
plot(theta,y,type="l")
sum(y)
integrate(y)
integrate(dbinom(12,20,x),lower=0,upper=1)
log(0.10)
log(0.15)
log(0.001)
nll.binom <- function(theta,x,N){
return(-log(dbinom(x, size = N, prob = theta)))
}
lines(theta,nll.binom(theta,12,20))
lines(theta,nll.binom(theta,12,20))
plot(theta,nll.binom(theta,12,20))
plot(theta,y,type="l")
plot(theta,nll.binom(theta,12,20))
optim(par=0.5, fn=nll.binom, x=12, N=20 )
data = rnorm(n=100, mean=2.85, sd=0.12)
hist(data)
data = rnorm(n=1000, mean=2.85, sd=0.12)
hist(data)
nll.normal <- function(data,mean,sd){
return(-sum(log(dnorm(data,mean,sd))))
}
optim(par=c(2.8,0.2), fn=nll.normal, dat=data)
optim(par=c(2.8,0.2), fn=nll.normal, data=data)
optim(c(3,2.8,0.2), fn=nll.normal, data=data)
nll.normal <- function(data,par){
return(-sum(log(dnorm(data,par[1],par[2]))))
}
optim(par=c(2.8,0.12), fn=nll.normal, data=data)
optim(par=c(1,0.2), fn=nll.normal, data=data)
mean(data)
sd(data)
nll.binom <- function(data,par){
return(-log(dbinom(data, size = 20, prob = par)))
}
optim(par=0.5, fn=nll.binom, data=12) # look at "par" output..this is the MLE
dexg <- function(x, mu, sigma, tau){
temp1 = (mu/tau)+(sigma^2/(2*tau^2))-(x/tau)
temp2 = ((x-mu)-(sigma^2/tau))/sigma
return(exp(temp1)*pnorm(temp2))/tau
}
x=seq(-4,6,0.1)
plot(x,dexg(x,0,1,1))
plot(x,dexg(x,-2,1,1))
plot(x,dexg(x,0,3,1))
plot(x,dexg(x,-3,1,0.25))
plot(x,dexg(x,0,1,1),type="l") # change parameters to see effects on shape of distribution
plot(x,dexg(x,-2,1,1),type="l") # change parameters to see effects on shape of distribution
nll.exg <- function(data,par){
return(-sum(log(dexg(data, mu=par[1], sd=par[2], tau=par[3]))))
}
install.packages("gamlss")
library(exGAUS)
library(gamlss)
rexGAUS(n=1000,mu=-3.2, sigma=1.3, nu=1.8)
x=rexGAUS(n=1000,mu=-3.2, sigma=1.3, nu=1.8)
plot(x,density(x))
plot(density(x))
write.csv(x)
setwd("~/github/courses/fall2017/psyc5316/homework/")
write.csv(x,file = "data.csv")
data <- read.csv("~/github/courses/fall2017/psyc5316/homework/data.csv")
data$x
hist(data$x)
optim(par=c(0,1,1), fn=nll.exg, data = data$x)
nll.exg <- function(data,par){
return(-sum(log(dexg(data, mu=par[1], sigma=par[2], tau=par[3]))))
}
optim(par=c(0,1,1), fn=nll.exg, data = data$x)
optim(par=c(0,0.2,1), fn=nll.exg, data = data$x)
optim(par=c(0,0.5,1), fn=nll.exg, data = data$x)
plot(density(x))
optim(par=c(-3,1,1), fn=nll.exg, data = data$x)
?exGAUS
Phi
?cnorm
?pnorm
pnorm(1)
dexg <- function(x, mu, sigma, tau){
return((1/tau)*exp((sigma^2/(2*tau^2))-(x-mu)/tau)*pnorm((x-mu)/sigma-(isgma/tau)))
}
x=seq(-4,6,0.1)
plot(x,dexg(x,-2,1,1),type="l") # change parameters to see effects on shape of distribution
dexg <- function(x, mu, sigma, tau){
return((1/tau)*exp((sigma^2/(2*tau^2))-(x-mu)/tau)*pnorm((x-mu)/sigma-(sigma/tau)))
}
x=seq(-4,6,0.1)
plot(x,dexg(x,-2,1,1),type="l") # change parameters to see effects on shape of distribution
plot(x,dexg(x,0.5,0.05,0.3),type="l") # change parameters to see effects on shape of distribution
x=seq(0,4,0.1)
plot(x,dexg(x,0.5,0.05,0.3),type="l") # change parameters to see effects on shape of distribution
plot(x,dexg(x,1,0.05,0.3),type="l") # change parameters to see effects on shape of distribution
plot(x,dexg(x,0.5,0.2,0.3),type="l") # change parameters to see effects on shape of distribution
x=rexGAUS(n=1000,mu=0.5, sigma=0.2, nu=0.3)
density(x)
plot(density(x))
dexg <- function(x, mu, sigma, tau){
return((1/tau)*exp((sigma^2/(2*tau^2))-(x-mu)/tau)*pnorm((x-mu)/sigma-(sigma/tau)))
}
nll.exg <- function(data,par){
return(-sum(log(dexg(data, mu=par[1], sigma=par[2], tau=par[3]))))
}
optim(par=c(-3,1,1), fn=nll.exg, data = x)
optim(par=c(0,0.5,0.5), fn=nll.exg, data = x)
y=seq(0,4,0.1)
plot(y,density(x))
plot(density(x))
lines(y,dexg(y,0.50, 0.215, 0.317))
lines(y,dexg(y,0.50, 0.215, 0.317),lty=2)
plot(density(x))
lines(y,dexg(y,0.50, 0.215, 0.317),lty=2)
optim(par=c(0,0.1,0.1), fn=nll.exg, data = x)
getwd()
x=rexGAUS(n=1000,mu=0.73, sigma=0.33, nu=0.12)
write.csv(x,"data.csv")
data <- read.csv("~/github/courses/fall2017/psyc5316/homework/data.csv")
data$x
hist(data$x)
plot(density(x))
x=rexGAUS(n=1000,mu=0.73, sigma=0.33, nu=0.42)
write.csv(x,"data.csv")
data <- read.csv("~/github/courses/fall2017/psyc5316/homework/data.csv")
plot(density(x))
optim(par=c(0,0.1,0.1), fn=nll.exg, data = data$x)
data <- read.csv("~/github/courses/fall2017/psyc5316/lectures/data2.csv")
plot(density(data$rt))
head(data)
plot(density(data$rt))
optim(par=c(0,0.1,0.1), fn=nll.exg, data = data$rt)
y=seq(0,4,0.1)
x=seq(0,4,0.1)
plot(density(data$rt))
lines(y,dexg(y,0.715, 0.336, 0.465),lty=2)
lines(y,dexg(y,mu=0.715, sigma=0.336, tau=0.465),lty=2)
x=rnorm(1000,2.85,0.12)
write.csv(x,"data1.csv")
data <- read.csv("~/github/courses/fall2017/psyc5316/lectures/data2.csv")
hist(data$x)
data <- read.csv("~/github/courses/fall2017/psyc5316/lectures/data1.csv")
data <- read.csv("~/github/courses/fall2017/psyc5316/lectures/data1.csv")
hist(data$x)
plot(density(x))
optim(par=c(1,0.1), fn=nll.normal, data=data$x) # look at par output; first number is mean, second is sd
x=seq(-3,4,0.1)
plot(density(x))
plot(density(data$x))
lines(x,dnorm(x,mean=2.85, sd=0.12),lty=2)
x=seq(-3,4,0.1)
lines(x,dnorm(x,mean=2.85, sd=0.12),lty=2)
y=seq(-3,4,0.1)
lines(y,dnorm(y,mean=2.85, sd=0.12),lty=2)
x=seq(-3,4,0.01)
plot(density(data$x))
lines(x,dnorm(x,mean=2.85, sd=0.12),lty=2)
x=seq(0,4,0.1)
plot(x,dexg(x,0.5,0.2,0.3),type="l") # change parameters to see effects on shape of distribution
x=seq(0,4,0.1)
plot(density(data$rt))
data <- read.csv("~/github/courses/fall2017/psyc5316/lectures/data2.csv")
head(data)
plot(density(data$rt))
nll.exg <- function(data,par){
return(-sum(log(dexg(data, mu=par[1], sigma=par[2], tau=par[3]))))
}
optim(par=c(0,0.1,0.1), fn=nll.exg, data = data$rt)  # look at par output -- first number = mu, second = sigma, third = tau
x=seq(0,4,0.1)
plot(density(data$rt))
lines(y,dexg(y,mu=0.715, sigma=0.336, tau=0.465),lty=2)
