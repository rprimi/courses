<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en">
<head>
<title>Week 5 lecture notes - PSYC 5316</title>
<!-- 2017-09-25 Mon 09:16 -->
<meta  http-equiv="Content-Type" content="text/html;charset=utf-8" />
<meta  name="generator" content="Org-mode" />
<style type="text/css">
 <!--/*--><![CDATA[/*><!--*/
  .title  { text-align: center; }
  .todo   { font-family: monospace; color: red; }
  .done   { color: green; }
  .tag    { background-color: #eee; font-family: monospace;
            padding: 2px; font-size: 80%; font-weight: normal; }
  .timestamp { color: #bebebe; }
  .timestamp-kwd { color: #5f9ea0; }
  .right  { margin-left: auto; margin-right: 0px;  text-align: right; }
  .left   { margin-left: 0px;  margin-right: auto; text-align: left; }
  .center { margin-left: auto; margin-right: auto; text-align: center; }
  .underline { text-decoration: underline; }
  #postamble p, #preamble p { font-size: 90%; margin: .2em; }
  p.verse { margin-left: 3%; }
  pre {
    border: 1px solid #ccc;
    box-shadow: 3px 3px 3px #eee;
    padding: 8pt;
    font-family: monospace;
    overflow: auto;
    margin: 1.2em;
  }
  pre.src {
    position: relative;
    overflow: visible;
    padding-top: 1.2em;
  }
  pre.src:before {
    display: none;
    position: absolute;
    background-color: white;
    top: -10px;
    right: 10px;
    padding: 3px;
    border: 1px solid black;
  }
  pre.src:hover:before { display: inline;}
  pre.src-sh:before    { content: 'sh'; }
  pre.src-bash:before  { content: 'sh'; }
  pre.src-emacs-lisp:before { content: 'Emacs Lisp'; }
  pre.src-R:before     { content: 'R'; }
  pre.src-perl:before  { content: 'Perl'; }
  pre.src-java:before  { content: 'Java'; }
  pre.src-sql:before   { content: 'SQL'; }

  table { border-collapse:collapse; }
  caption.t-above { caption-side: top; }
  caption.t-bottom { caption-side: bottom; }
  td, th { vertical-align:top;  }
  th.right  { text-align: center;  }
  th.left   { text-align: center;   }
  th.center { text-align: center; }
  td.right  { text-align: right;  }
  td.left   { text-align: left;   }
  td.center { text-align: center; }
  dt { font-weight: bold; }
  .footpara:nth-child(2) { display: inline; }
  .footpara { display: block; }
  .footdef  { margin-bottom: 1em; }
  .figure { padding: 1em; }
  .figure p { text-align: center; }
  .inlinetask {
    padding: 10px;
    border: 2px solid gray;
    margin: 10px;
    background: #ffffcc;
  }
  #org-div-home-and-up
   { text-align: right; font-size: 70%; white-space: nowrap; }
  textarea { overflow-x: auto; }
  .linenr { font-size: smaller }
  .code-highlighted { background-color: #ffff00; }
  .org-info-js_info-navigation { border-style: none; }
  #org-info-js_console-label
    { font-size: 10px; font-weight: bold; white-space: nowrap; }
  .org-info-js_search-highlight
    { background-color: #ffff00; color: #000000; font-weight: bold; }
  /*]]>*/-->
</style>
<script type="text/javascript">
/*
@licstart  The following is the entire license notice for the
JavaScript code in this tag.

Copyright (C) 2012-2013 Free Software Foundation, Inc.

The JavaScript code in this tag is free software: you can
redistribute it and/or modify it under the terms of the GNU
General Public License (GNU GPL) as published by the Free Software
Foundation, either version 3 of the License, or (at your option)
any later version.  The code is distributed WITHOUT ANY WARRANTY;
without even the implied warranty of MERCHANTABILITY or FITNESS
FOR A PARTICULAR PURPOSE.  See the GNU GPL for more details.

As additional permission under GNU GPL version 3 section 7, you
may distribute non-source (e.g., minimized or compacted) forms of
that code without the copy of the GNU GPL normally required by
section 4, provided you include this license notice and a URL
through which recipients can access the Corresponding Source.


@licend  The above is the entire license notice
for the JavaScript code in this tag.
*/
<!--/*--><![CDATA[/*><!--*/
 function CodeHighlightOn(elem, id)
 {
   var target = document.getElementById(id);
   if(null != target) {
     elem.cacheClassElem = elem.className;
     elem.cacheClassTarget = target.className;
     target.className = "code-highlighted";
     elem.className   = "code-highlighted";
   }
 }
 function CodeHighlightOff(elem, id)
 {
   var target = document.getElementById(id);
   if(elem.cacheClassElem)
     elem.className = elem.cacheClassElem;
   if(elem.cacheClassTarget)
     target.className = elem.cacheClassTarget;
 }
/*]]>*///-->
</script>
</head>
<body>
<div id="content">
<h1 class="title">Week 5 lecture notes - PSYC 5316</h1>

<div id="outline-container-sec-1" class="outline-2">
<h2 id="sec-1">Introduction</h2>
<div class="outline-text-2" id="text-1">
<p>
In this lecture, we will learn how to work with large data sets.  Data sets are commonly represented as <i>data frames</i>.  To begin, we'll use the <code>read_csv</code> function to load a data frame.  First, load the <code>tidyverse</code> package, and then execute the <code>read_csv</code> commmand.
</p>

<pre class="example">
library(tidyverse)
rawdata = read_csv("https://git.io/vdkRH")
</pre>

<p>
(Note: if you haven't already installed <code>tidyverse</code>, you can do so by executing <code>install.packages("tidyverse")</code> at the console.
</p>

<p>
This data set comes from Experiment 2 of Faulkenberry, Cruise, Lavro, and Shaki (2016).  In this experiment, we presented people with pairs of single-digit numbers written in two different font sizes. We asked them to use a computer mouse to click on the <i>physically larger</i> of the pair.  This resulted in experimental conditions: <i>congruent</i> trials, where the physically larger number was also numerically larger, and <i>incongruent</i> trials, where the physically larger number was numerically smaller.  We measured RT in milliseconds.
</p>

<p>
The data file is structured with the following columns:
</p>

<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="left" />

<col  class="left" />
</colgroup>
<thead>
<tr>
<th scope="col" class="left">column</th>
<th scope="col" class="left">description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="left">subject</td>
<td class="left">number representing subject identifier</td>
</tr>

<tr>
<td class="left">condition</td>
<td class="left">size-congruity condition: either "congruent" or "incongruent"</td>
</tr>

<tr>
<td class="left">distance</td>
<td class="left">numerical distance between presented numbers (1,2,3, or 4)</td>
</tr>

<tr>
<td class="left">error</td>
<td class="left">indicates whether error was made on trial: 0 = no error, 1=error</td>
</tr>

<tr>
<td class="left">RT</td>
<td class="left">response time in milliseconds</td>
</tr>

<tr>
<td class="left">side</td>
<td class="left">side of display on which the physically larger number was presented (either left or right)</td>
</tr>

<tr>
<td class="left">&#xa0;</td>
<td class="left">&#xa0;</td>
</tr>
</tbody>
</table>
</div>
</div>
<div id="outline-container-sec-2" class="outline-2">
<h2 id="sec-2">What are data frames?</h2>
<div class="outline-text-2" id="text-2">
<p>
Data frames are the de facto data structure for most tabular data, and what we use for statistics and plotting.
</p>

<p>
A data frame is the representation of data in the format of a table where the columns are vectors that all have the same length. Because the column are vectors, they all contain the same type of data (e.g., characters, integers, factors).
</p>

<p>
We can see this when inspecting the structure of our data frame with the function <code>glimpse</code>:
</p>

<pre class="example">
glimpse(rawdata)
</pre>

<p>
In addition to <code>glimpse</code>, there are some other functions that will help you to get a sense of the content/structure of your data:
</p>

<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="left" />

<col  class="left" />
</colgroup>
<tbody>
<tr>
<td class="left">Size</td>
<td class="left">&#xa0;</td>
</tr>

<tr>
<td class="left"><code>dim</code></td>
<td class="left">returns a vector with the number of rows in the first element, and the number of columns as the second element</td>
</tr>

<tr>
<td class="left"><code>nrow</code></td>
<td class="left">returns the number of rows</td>
</tr>

<tr>
<td class="left"><code>ncol</code></td>
<td class="left">returns the number of columns</td>
</tr>

<tr>
<td class="left">Content</td>
<td class="left">&#xa0;</td>
</tr>

<tr>
<td class="left"><code>head</code></td>
<td class="left">shows the first 6 rows</td>
</tr>

<tr>
<td class="left"><code>tail</code></td>
<td class="left">shows the last 6 rows</td>
</tr>

<tr>
<td class="left"><code>names</code></td>
<td class="left">returns the column names</td>
</tr>
</tbody>
</table>
</div>
</div>


<div id="outline-container-sec-3" class="outline-2">
<h2 id="sec-3">Data manipulation using <code>tidyr</code> and <code>dplyr</code></h2>
<div class="outline-text-2" id="text-3">
<p>
<code>dplyr</code> is a package for making tabular data manipulation easier. It pairs nicely with <code>tidyr</code> which enables you to swiftly convert between different data formats for plotting and analysis.
</p>

<p>
The package <code>dplyr</code> provides easy tools for the most common data manipulation tasks. It is built to work directly with data frames, with many common tasks optimized by being written in a compiled language (C++). An additional feature is the ability to work directly with data stored in an external database. The benefits of doing this are that the data can be managed natively in a relational database, queries can be conducted on that database, and only the results of the query are returned.
</p>

<p>
This addresses a common problem with R in that all operations are conducted in-memory and thus the amount of data you can work with is limited by available memory. The database connections essentially remove that limitation in that you can have a database of many 100s GB, conduct queries on it directly, and pull back into R only what you need for analysis.
</p>

<p>
The package <code>tidyr</code> addresses the common problem of wanting to reshape your data for plotting and use by different R functions. Sometimes we want data sets where we have one row per measurement. Sometimes we want a data frame where each measurement type has its own column, and rows are instead more aggregated groups. Moving back and forth between these formats is nontrivial, and <code>tidyr</code> gives you tools for this and more sophisticated data manipulation.
</p>
</div>

<div id="outline-container-sec-3-1" class="outline-3">
<h3 id="sec-3-1">Selecting columns and filtering rows</h3>
<div class="outline-text-3" id="text-3-1">
<p>
We're going to learn some of the most common <code>dplyr</code> functions (also called <b>verbs</b>): <code>select()</code>, <code>filter()</code>, <code>mutate()</code>, <code>group_by()</code>, and <code>summarize()</code>. 
</p>

<p>
To choose <i>columns</i> of a data frame, use <code>select()</code>. The first argument to this function is the data frame (<code>rawdata</code>), and the subsequent arguments are the columns to keep.
</p>

<pre class="example">
select(rawdata, condition, error, RT)
</pre>

<p>
To choose <i>rows</i> based on specific criteria, use <code>filter()</code>
</p>

<pre class="example">
filter(rawdata, error==0)
</pre>
</div>
</div>

<div id="outline-container-sec-3-2" class="outline-3">
<h3 id="sec-3-2">Pipes</h3>
<div class="outline-text-3" id="text-3-2">
<p>
But what if you wanted to select and filter at the same time?  There are many ways to do this, but the quickest and easiest is to use <b>pipes</b>.
</p>

<p>
Pipes are a fairly recent addition to R. Pipes let you take the output of one function and send it directly to the next, which is useful when you need to do many things to the same dataset. Pipes in R look like <code>%&gt;%</code> and are made available via the <code>magrittr</code> package, installed automatically with <code>dplyr</code>. 
</p>

<pre class="example">
rawdata %&gt;%
  filter(error==0) %&gt;%
  select(subject, condition, RT)
</pre>

<p>
In the above code chunk, we use the pipe to send the <code>rawdata</code> dataset first through <code>filter()</code> to keep only the rows where <code>error=0</code>.  Then, we pass that output through the <code>select()</code> function to keep only the columns <code>subject</code>, <code>condition</code>, and <code>RT</code>.
</p>

<p>
Note that using the pipe operator <code>%&gt;%</code> removes the need to specify the dataset as the first argument to the <code>filter()</code> or <code>select()</code> functions.
</p>

<p>
If we wanted to create a new object of this smaller version of the data, we could do so by using the assignment operator <code>&lt;-</code>:
</p>

<pre class="example">
data &lt;- rawdata %&gt;%
  filter(error==0)
</pre>
</div>
</div>
</div>
</div>
<div id="postamble" class="status">
<p class="date">Date: September 25, 2017</p>
<p class="date">Created: 2017-09-25 Mon 09:16</p>
<p class="creator"><a href="http://www.gnu.org/software/emacs/">Emacs</a> 25.2.1 (<a href="http://orgmode.org">Org</a> mode 8.2.10)</p>
<p class="validation"><a href="http://validator.w3.org/check?uri=referer">Validate</a></p>
</div>
</body>
</html>
