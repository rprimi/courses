_
)
plot(x,dlnorm(x,meanlog=log(1000),sdlog=0.1,type="l")
)
plot(x,dlnorm(x,meanlog=log(1000),sdlog=0.1),type="l")
plot(x,dlnorm(x,meanlog=log(1000),sdlog=0.2),type="l")
plot(x,dlnorm(x,meanlog=log(1000),sdlog=1),type="l")
lognormalFit <- function(subj){
RTs <- dataTrue %>%
filter(subject_nr==subj) %>%
select(rt)
inits <- c(min(RTs), 5, 0.8)
params <- optim(inits, nll.lnorm, dat=RTs$rt)
x <- seq(0,3000,1)
plot(density(RTs$rt),lwd=2,xlab="RT (msec)",main="")
lines(x,dlnorm(x-params$par[1], shape = params$par[2], scale=params$par[3]),lty=2,lwd=2)
}
lognormalFit(101)
lognormalFit <- function(subj){
RTs <- dataTrue %>%
filter(subject_nr==subj) %>%
select(rt)
inits <- c(min(RTs), 1, 1)
params <- optim(inits, nll.lnorm, dat=RTs$rt)
x <- seq(0,3000,1)
plot(density(RTs$rt),lwd=2,xlab="RT (msec)",main="")
lines(x,dlnorm(x-params$par[1], shape = params$par[2], scale=params$par[3]),lty=2,lwd=2)
}
lognormalFit(101)
inits
nll.lnorm(inits,RTs$rt)
inits<-c(800,5,0.1)
nll.lnorm(inits,RTs$rt)
lognormalFit <- function(subj){
RTs <- dataTrue %>%
filter(subject_nr==subj) %>%
select(rt)
inits <- c(min(RTs), 1, 0.1)
params <- optim(inits, nll.lnorm, dat=RTs$rt)
x <- seq(0,3000,1)
plot(density(RTs$rt),lwd=2,xlab="RT (msec)",main="")
lines(x,dlnorm(x-params$par[1], shape = params$par[2], scale=params$par[3]),lty=2,lwd=2)
}
lognormalFit(101)
lognormalFit(102)
lognormalFit <- function(subj){
RTs <- dataTrue %>%
filter(subject_nr==subj) %>%
select(rt)
inits <- c(min(RTs), 5, 0.1)
params <- optim(inits, nll.lnorm, dat=RTs$rt)
x <- seq(0,3000,1)
plot(density(RTs$rt),lwd=2,xlab="RT (msec)",main="")
lines(x,dlnorm(x-params$par[1], shape = params$par[2], scale=params$par[3]),lty=2,lwd=2)
}
lognormalFit(102)
RTs
min(RTs)
inits
inits[1]<-895
inits
nll.lnorm(inits,RTs$rt)
inits[1]=800
nll.lnorm(inits,RTs$rt)
inits[1]=895
inits[2]=1
inits[3]=0.1
nll.lnorm(inits,RTs$rt)
x
plot(x,dlnorm(x-895,5,1))
plot(x,dlnorm(x-895,5,1),type="l")
plot(x,dlnorm(x-895,5,2),type="l")
plot(x,dlnorm(x-895,5,.1),type="l")
plot(x,dlnorm(x-895,5,1),type="l")
plot(x,dlnorm(x-895,4,1),type="l")
plot(x,dlnorm(x-895,10,1),type="l")
plot(x,dlnorm(x-895,7,1),type="l")
plot(x,dlnorm(x-895,6,1),type="l")
lognormalFit <- function(subj){
RTs <- dataTrue %>%
filter(subject_nr==subj) %>%
select(rt)
inits <- c(min(RTs), 6, 1)
params <- optim(inits, nll.lnorm, dat=RTs$rt)
x <- seq(0,3000,1)
plot(density(RTs$rt),lwd=2,xlab="RT (msec)",main="")
lines(x,dlnorm(x-params$par[1], shape = params$par[2], scale=params$par[3]),lty=2,lwd=2)
}
lognormalFit(102)
lognormalFit <- function(subj){
RTs <- dataTrue %>%
filter(subject_nr==subj) %>%
select(rt)
inits <- c(min(RTs), 6, 1)
params <- optim(inits, nll.lnorm, dat=RTs$rt)
x <- seq(0,3000,1)
plot(density(RTs$rt),lwd=2,xlab="RT (msec)",main="")
lines(x,dlnorm(x-params$par[1], meanlog = params$par[2], sdlog =params$par[3]),lty=2,lwd=2)
}
lognormalFit(102)
nll.lnorm(inits,RTs$rt)
inits
inits=c(895,6,1)
nll.lnorm(inits,RTs$rt)
exp(6)
mean(log(RTs$rt))
sd(log(RTs$rt))
nll.lnorm(c(895,7.18,0.23))
nll.lnorm(c(895,7.18,0.23),RTs$rt)
plot(x,dlnorm(x,7.18,0.23))
plot(x,dlnorm(x-895,7.18,0.23))
plot(x,dlnorm(x+895,7.18,0.23))
plot(x,dweibull(x-895,1,1))
plot(x,dweibull(x-895,5,1))
plot(x,dweibull(x-895,0.2,1))
plot(x,dweibull(x-895,0.2,5))
plot(x,dweibull(x-895,0.2,500))
plot(x,dweibull(x-895,1.2,500))
plot(x,dweibull(x,1.2,500))
plot(x,dlnorm(x-895,7.18,0.23))
plot(x,dlnorm(x-895,5.18,0.23))
plot(x,dlnorm(x-895,5.18,0.5))
lognormalFit <- function(subj){
RTs <- dataTrue %>%
filter(subject_nr==subj) %>%
select(rt)
inits <- c(min(RTs), 5, 0.5)
params <- optim(inits, nll.lnorm, dat=RTs$rt)
x <- seq(0,3000,1)
plot(density(RTs$rt),lwd=2,xlab="RT (msec)",main="")
lines(x,dlnorm(x-params$par[1], meanlog = params$par[2], sdlog =params$par[3]),lty=2,lwd=2)
}
lognormalFit(102)
min(RTs)
exp(5)
plot(x,dlnorm(x-895,5.18,1))
plot(x,dlnorm(x-895,5.18,5))
plot(x,dlnorm(x-895,5.18,.1))
plot(x,dlnorm(x-895,5,1))
plot(x,dlnorm(x-895,5,.5))
plot(x,dlnorm(x-895,5,3))
sd(log(RTs$rt))
plot(x,dlnorm(x-895,5,.23))
nll.lnorm(inits,RTs$rt)
nll.lnorm(c(500,5,1),RTs$rt)
lognormalFit <- function(subj){
RTs <- dataTrue %>%
filter(subject_nr==subj) %>%
select(rt)
inits <- c(0, 5, 0.5)
params <- optim(inits, nll.lnorm, dat=RTs$rt)
x <- seq(0,3000,1)
plot(density(RTs$rt),lwd=2,xlab="RT (msec)",main="")
lines(x,dlnorm(x-params$par[1], meanlog = params$par[2], sdlog =params$par[3]),lty=2,lwd=2)
}
lognormalFit(102)
lognormalFit <- function(subj){
RTs <- dataTrue %>%
filter(subject_nr==subj) %>%
select(rt)
inits <- c(0, 5, 1)
params <- optim(inits, nll.lnorm, dat=RTs$rt)
x <- seq(0,3000,1)
plot(density(RTs$rt),lwd=2,xlab="RT (msec)",main="")
lines(x,dlnorm(x-params$par[1], meanlog = params$par[2], sdlog =params$par[3]),lty=2,lwd=2)
}
lognormalFit(102)
lognormalFit(103)
lognormalFit(101)
lognormalFit(102)
lognormalFit(103)
lognormalFit(104)
lognormalFit(105)
lognormalFit(106)
lognormalFit(107)
lognormalFit(108)
lognormalFit(109)
lognormalFit(110)
lognormalFit(111)
lognormalFit(112)
lognormalFit(113)
lognormalFit(114)
lognormalFit(115)
lognormalFit(116)
lognormalFit(117)
lognormalFit(118)
lognormalFit(119)
lognormalFit(120)
lognormalFit(121)
lognormalFit(122)
lognormalFit(123)
lognormalFit(124)
lognormalFit(125)
weibullFit(122)
compareFits <- function(subj}{
RTs <- dataTrue %>%
filter(subject_nr==subj) %>%
select(rt)
initsWeibull <- c(min(RTs), 1, 1) #shift, shape, scale
paramsWeibull <- optim(initsWeibull, nll.wei, dat=RTs$rt)
initsLog <- c(0, 5, 1)
paramsLog <- optim(initsLog, nll.lnorm, dat=RTs$rt)
x <- seq(0,3000,1)
plot(density(RTs$rt),lwd=2,xlab="RT (msec)",main="")
lines(x,dlnorm(x-paramsLog$par[1], meanlog = paramsLog$par[2], sdlog =paramsLog$par[3]),lty=2,lwd=2)
lines(x,dweibull(x-paramsWeibull$par[1], shape = paramsWeibull$par[2], scale=paramsWeibull$par[3]),lty=3,lwd=2)
}
compareFits <- function(subj){
RTs <- dataTrue %>%
filter(subject_nr==subj) %>%
select(rt)
initsWeibull <- c(min(RTs), 1, 1) #shift, shape, scale
paramsWeibull <- optim(initsWeibull, nll.wei, dat=RTs$rt)
initsLog <- c(0, 5, 1)
paramsLog <- optim(initsLog, nll.lnorm, dat=RTs$rt)
x <- seq(0,3000,1)
plot(density(RTs$rt),lwd=2,xlab="RT (msec)",main="")
lines(x,dlnorm(x-paramsLog$par[1], meanlog = paramsLog$par[2], sdlog =paramsLog$par[3]),lty=2,lwd=2)
lines(x,dweibull(x-paramsWeibull$par[1], shape = paramsWeibull$par[2], scale=paramsWeibull$par[3]),lty=3,lwd=2)
}
compareFits(101)
compareFits <- function(subj){
RTs <- dataTrue %>%
filter(subject_nr==subj) %>%
select(rt)
initsWeibull <- c(min(RTs), 1, 1) #shift, shape, scale
paramsWeibull <- optim(initsWeibull, nll.wei, dat=RTs$rt)
initsLog <- c(0, 5, 1)
paramsLog <- optim(initsLog, nll.lnorm, dat=RTs$rt)
x <- seq(0,3000,1)
plot(density(RTs$rt),lwd=2,xlab="RT (msec)",main="")
lines(x,dlnorm(x-paramsLog$par[1], meanlog = paramsLog$par[2], sdlog =paramsLog$par[3]),lty=2,lwd=2)
lines(x,dweibull(x-paramsWeibull$par[1], shape = paramsWeibull$par[2], scale=paramsWeibull$par[3]),lty=3,lwd=2)
legend(2500,0.001,legend=c("lognormal","Weibull"),lty=2:3)
}
compareFits(101)
compareFits(102)
compareFits(103)
compareFits <- function(subj){
RTs <- dataTrue %>%
filter(subject_nr==subj) %>%
select(rt)
initsWeibull <- c(min(RTs), 1, 1) #shift, shape, scale
paramsWeibull <- optim(initsWeibull, nll.wei, dat=RTs$rt)
initsLog <- c(0, 5, 1)
paramsLog <- optim(initsLog, nll.lnorm, dat=RTs$rt)
x <- seq(0,3000,1)
plot(density(RTs$rt),lwd=2,xlab="RT (msec)",main="")
lines(x,dlnorm(x-paramsLog$par[1], meanlog = paramsLog$par[2], sdlog =paramsLog$par[3]),lty=2,lwd=2)
lines(x,dweibull(x-paramsWeibull$par[1], shape = paramsWeibull$par[2], scale=paramsWeibull$par[3]),lty=3,lwd=2)
legend(max(RTs)-500,0.001,legend=c("lognormal","Weibull"),lty=2:3)
}
compareFits(103)
compareFits(101)
density(RTs$rt)
max(density(RTs$rt))
obj <- density(RTs$rt)
ls(obj)
obj$y
max(obj$y)
compareFits <- function(subj){
RTs <- dataTrue %>%
filter(subject_nr==subj) %>%
select(rt)
initsWeibull <- c(min(RTs), 1, 1) #shift, shape, scale
paramsWeibull <- optim(initsWeibull, nll.wei, dat=RTs$rt)
initsLog <- c(0, 5, 1)
paramsLog <- optim(initsLog, nll.lnorm, dat=RTs$rt)
x <- seq(0,3000,1)
plot(density(RTs$rt),lwd=2,xlab="RT (msec)",main="")
lines(x,dlnorm(x-paramsLog$par[1], meanlog = paramsLog$par[2], sdlog =paramsLog$par[3]),lty=2,lwd=2)
lines(x,dweibull(x-paramsWeibull$par[1], shape = paramsWeibull$par[2], scale=paramsWeibull$par[3]),lty=3,lwd=2)
legend(max(RTs)-500,max(density(RTs$rt)$y),legend=c("lognormal","Weibull"),lty=2:3)
}
compareFits(101)
compareFits(102)
compareFits(103)
compareFits(104)
compareFits(105)
compareFits(106)
compareFits(107)
compareFits(108)
?optim
dwald <- function(x,lambda,phi){
sqrt(lambda/(2*pi))*x^(-1.5)*exp(-(x*phi-lambda)^2/(2*lambda*x))
}
nll.wald <- function(par,dat){
return(-sum(log(dwald(dat-par[1],lambda=par[2],phi=par[3]))))
}
plot(x,dwald(x-500,1,1))
plot(x,dwald(x-500,20,1))
plot(x,dwald(x-500,20,20))
plot(x,dwald(x-500,50,20))
plot(x,dwald(x-500,50,20),type="l")
plot(x,dwald(x-500,50,3),type="l")
plot(x,dwald(x-500,20,3),type="l")
plot(x,dwald(x-500,20,2),type="l")
plot(x,dwald(x-500,100,2),type="l")
plot(x,dwald(x-500,200,2),type="l")
plot(x,dwald(x-500,200,30),type="l")
plot(x,dwald(x-500,200,1),type="l")
plot(x,dwald(x-500,200,0.2),type="l")
nll.wald(c(0,100,1),RTs$rt)
waldFit <- function(subj){
RTs <- dataTrue %>%
filter(subject_nr==subj) %>%
select(rt)
inits <- c(0,100,1)
params <- optim(inits,nll.wald, dat=RTs$rt)
x <- seq(0,3000,1)
plot(density(RTs$rt),lwd=2,xlab="RT (msec)",main="")
lines(x,dwald(x-params$par[1], lambda=params$par[2], phi=params$par[3]),lty=2,lwd=2)
}
waldFit(101)
waldFit(102)
waldFit(103)
waldFit(104)
waldFit(105)
waldFit(106)
waldFit(107)
waldFit(108)
waldFit(109)
waldFit(110)
waldFit(111)
waldFit(112)
waldFit(113)
waldFit(114)
waldFit(115)
waldFit(116)
waldFit(117)
nll.wald(c(0,100,1),RTs$rt)
optim(c(0,100,1),nll.wald,dat=RTs$rt)
?optim
waldFit <- function(subj){
RTs <- dataTrue %>%
filter(subject_nr==subj) %>%
select(rt)
inits <- c(0,100,1)
params <- optim(inits,nll.wald, dat=RTs$rt)
aic <- 2*params$value+2*3
x <- seq(0,3000,1)
plot(density(RTs$rt),lwd=2,xlab="RT (msec)",main="")
lines(x,dwald(x-params$par[1], lambda=params$par[2], phi=params$par[3]),lty=2,lwd=2)
text(2000,0.001,expression(paste("AIC = ",aic)))
}
waldFit(117)
text(2000,0.001,"AIC")
text(2000,0.001,paste("AIC",AIC()))
waldFit <- function(subj){
RTs <- dataTrue %>%
filter(subject_nr==subj) %>%
select(rt)
inits <- c(0,100,1)
params <- optim(inits,nll.wald, dat=RTs$rt)
aic <- 2*params$value+2*3
x <- seq(0,3000,1)
plot(density(RTs$rt),lwd=2,xlab="RT (msec)",main="")
lines(x,dwald(x-params$par[1], lambda=params$par[2], phi=params$par[3]),lty=2,lwd=2)
text(2000,0.001,paste("AIC = ", aic))
}
waldFit(117)
waldFit(115)
waldFit(111)
waldFit(110)
waldFit(101)
waldFit(102)
waldFit(103)
waldFit <- function(subj){
RTs <- dataTrue %>%
filter(subject_nr==subj) %>%
select(rt)
inits <- c(0,100,1)
params <- optim(inits,nll.wald, dat=RTs$rt)
aic <- 2*params$value+2*length(params$par)
x <- seq(0,3000,1)
plot(density(RTs$rt),lwd=2,xlab="RT (msec)",main="")
lines(x,dwald(x-params$par[1], lambda=params$par[2], phi=params$par[3]),lty=2,lwd=2)
text(2000,0.001,paste("AIC = ", aic))
}
waldFit(103)
waldFit(102)
waldFit <- function(subj){
RTs <- dataTrue %>%
filter(subject_nr==subj) %>%
select(rt)
inits <- c(0,100,1)
params <- optim(inits,nll.wald, dat=RTs$rt)
aic <- 2*params$value+2*length(params$par)
x <- seq(0,3000,1)
plot(density(RTs$rt),lwd=2,xlab="RT (msec)",main="")
lines(x,dwald(x-params$par[1], lambda=params$par[2], phi=params$par[3]),lty=2,lwd=2)
text(max(RTs)-500,max(density(RTs$rt)$y),paste("AIC = ", aic))
}
waldFit(102)
waldFit <- function(subj){
RTs <- dataTrue %>%
filter(subject_nr==subj) %>%
select(rt)
inits <- c(0,100,1)
params <- optim(inits,nll.wald, dat=RTs$rt)
aic <- 2*params$value+2*length(params$par)
x <- seq(0,3000,1)
plot(density(RTs$rt),lwd=2,xlab="RT (msec)",main="")
lines(x,dwald(x-params$par[1], lambda=params$par[2], phi=params$par[3]),lty=2,lwd=2)
text(max(RTs)-500,0.6*max(density(RTs$rt)$y),paste("AIC = ", aic))
}
waldFit(102)
weibullFit <- function(subj){
RTs <- dataTrue %>%
filter(subject_nr==subj) %>%
select(rt)
inits <- c(min(RTs), 1, 1) #shift, shape, scale
params <- optim(inits, nll.wei, dat=RTs$rt)
aic <- 2*params$value+2*length(params$par)
x <- seq(0,3000,1)
plot(density(RTs$rt),lwd=2,xlab="RT (msec)",main="")
lines(x,dweibull(x-params$par[1], shape = params$par[2], scale=params$par[3]),lty=2,lwd=2)
text(max(RTs)-500,0.6*max(density(RTs$rt)$y),paste("AIC = ", aic))
}
weibullFit(102)
lognormalFit <- function(subj){
RTs <- dataTrue %>%
filter(subject_nr==subj) %>%
select(rt)
inits <- c(0, 5, 1)
params <- optim(inits, nll.lnorm, dat=RTs$rt)
aic <- 2*params$value+2*length(params$par)
x <- seq(0,3000,1)
plot(density(RTs$rt),lwd=2,xlab="RT (msec)",main="")
lines(x,dlnorm(x-params$par[1], meanlog = params$par[2], sdlog =params$par[3]),lty=2,lwd=2)
text(max(RTs)-500,0.6*max(density(RTs$rt)$y),paste("AIC = ", aic))
}
lognormalFit(102)
par(mfrow=c(3,1))
weibullFit(101)
lognormalFit(101)
waldFit(101)
par(mfrow=c(1,3))
weibullFit(101)
lognormalFit(101)
waldFit(101)
par(mfrow=c(3,1))
weibullFit(101)
lognormalFit(101)
waldFit(101)
par(mfrow=c(3,1))
weibullFit(102)
lognormalFit(102)
waldFit(102)
par(mfrow=c(3,1))
weibullFit(103)
lognormalFit(103)
waldFit(103)
par(mfrow=c(3,1))
weibullFit(104)
lognormalFit(104)
waldFit(104)
par(mfrow=c(3,1))
weibullFit(105)
lognormalFit(105)
waldFit(105)
dbinom(x=8, size=10, prob=0.5)
dbinom(x=8, size=10, prob=0.5) +
dbinom(x=9, size=10, prob=0.5)+
dbinom(x=10, size=10, prob=0.5)
dbinom(x=9, size=10, prob=0.5)+
dbinom(x=10, size=10, prob=0.5)
pbinom(9,size=10,prob=0.5)
1-pbinom(9,size=10,prob=0.5)
?dbinom
1-pbinom(8,size=10,prob=0.5)
?dnorm
x=seq(0,200,0.1)
plot(x,dnorm(x,100,15),type="l")
lines(x,dnorm(x,100,20), lty=2)
lines(x,dnorm(x,100,30), lty=2)
pnorm(0)
pnorm(200,230,20)
pnorm(240,230,20)
1-pnorm(240,230,20)
pnorm(250,230,20)-pnorm(210,230,20)
?qnorm
qnorm(0.95, mean=230, sd=20)
qnorm(c(0.025,0.075), mean=230,sd=20)
qnorm(c(0.025,0.975), mean=230,sd=20)
x = c(1,2,3,4,5)
p = c(0.15, 0.2, 0.3, 0.2, 0.15)
sum(x*p)
sum((x-3)^2*p)
barplot(p)
p = c(0.2, 0.2, 0.3, 0.2, 0.10)
barplot(p)
p = c(0.15, 0.25, 0.3, 0.2, 0.10)
barplot(p)
sum(x*p)
sum((x-3)^2*p)
2.85-1.45
2.85+1.45
x=0:30
barplot(dbinom(x,30,0.3))
barplot(dbinom(x,30,0.3),names.arg=x)
dbinom(5,5,0.3)
barplot(dbinom(0:20,size=20,prob=0.7),names.arg=0:20)
barplot(dbinom(0:20,size=20,prob=0.7),names.arg=0:20,ylab="p(x)")
barplot(dbinom(0:20,size=20,prob=0.7),names.arg=0:20,ylab="p(x)",xlab="x")
setwd("~/github/courses/fall2017/psyc5316/lectures/figures/week2"
)
theta=seq(from=0, to=1, by=0.01)
plot(theta, dbinom(x=12, size=20, prob=theta), type="l")
plot(theta, dbinom(x=12, size=20, prob=theta),
type="l",ylab="likelihood")
abline(v=0.6)
