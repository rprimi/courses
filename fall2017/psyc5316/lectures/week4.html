<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en">
<head>
<title>Week 4 lecture notes - PSYC 5316</title>
<!-- 2017-09-15 Fri 10:29 -->
<meta  http-equiv="Content-Type" content="text/html;charset=utf-8" />
<meta  name="generator" content="Org-mode" />
<style type="text/css">
 <!--/*--><![CDATA[/*><!--*/
  .title  { text-align: center; }
  .todo   { font-family: monospace; color: red; }
  .done   { color: green; }
  .tag    { background-color: #eee; font-family: monospace;
            padding: 2px; font-size: 80%; font-weight: normal; }
  .timestamp { color: #bebebe; }
  .timestamp-kwd { color: #5f9ea0; }
  .right  { margin-left: auto; margin-right: 0px;  text-align: right; }
  .left   { margin-left: 0px;  margin-right: auto; text-align: left; }
  .center { margin-left: auto; margin-right: auto; text-align: center; }
  .underline { text-decoration: underline; }
  #postamble p, #preamble p { font-size: 90%; margin: .2em; }
  p.verse { margin-left: 3%; }
  pre {
    border: 1px solid #ccc;
    box-shadow: 3px 3px 3px #eee;
    padding: 8pt;
    font-family: monospace;
    overflow: auto;
    margin: 1.2em;
  }
  pre.src {
    position: relative;
    overflow: visible;
    padding-top: 1.2em;
  }
  pre.src:before {
    display: none;
    position: absolute;
    background-color: white;
    top: -10px;
    right: 10px;
    padding: 3px;
    border: 1px solid black;
  }
  pre.src:hover:before { display: inline;}
  pre.src-sh:before    { content: 'sh'; }
  pre.src-bash:before  { content: 'sh'; }
  pre.src-emacs-lisp:before { content: 'Emacs Lisp'; }
  pre.src-R:before     { content: 'R'; }
  pre.src-perl:before  { content: 'Perl'; }
  pre.src-java:before  { content: 'Java'; }
  pre.src-sql:before   { content: 'SQL'; }

  table { border-collapse:collapse; }
  caption.t-above { caption-side: top; }
  caption.t-bottom { caption-side: bottom; }
  td, th { vertical-align:top;  }
  th.right  { text-align: center;  }
  th.left   { text-align: center;   }
  th.center { text-align: center; }
  td.right  { text-align: right;  }
  td.left   { text-align: left;   }
  td.center { text-align: center; }
  dt { font-weight: bold; }
  .footpara:nth-child(2) { display: inline; }
  .footpara { display: block; }
  .footdef  { margin-bottom: 1em; }
  .figure { padding: 1em; }
  .figure p { text-align: center; }
  .inlinetask {
    padding: 10px;
    border: 2px solid gray;
    margin: 10px;
    background: #ffffcc;
  }
  #org-div-home-and-up
   { text-align: right; font-size: 70%; white-space: nowrap; }
  textarea { overflow-x: auto; }
  .linenr { font-size: smaller }
  .code-highlighted { background-color: #ffff00; }
  .org-info-js_info-navigation { border-style: none; }
  #org-info-js_console-label
    { font-size: 10px; font-weight: bold; white-space: nowrap; }
  .org-info-js_search-highlight
    { background-color: #ffff00; color: #000000; font-weight: bold; }
  /*]]>*/-->
</style>
<script type="text/javascript">
/*
@licstart  The following is the entire license notice for the
JavaScript code in this tag.

Copyright (C) 2012-2013 Free Software Foundation, Inc.

The JavaScript code in this tag is free software: you can
redistribute it and/or modify it under the terms of the GNU
General Public License (GNU GPL) as published by the Free Software
Foundation, either version 3 of the License, or (at your option)
any later version.  The code is distributed WITHOUT ANY WARRANTY;
without even the implied warranty of MERCHANTABILITY or FITNESS
FOR A PARTICULAR PURPOSE.  See the GNU GPL for more details.

As additional permission under GNU GPL version 3 section 7, you
may distribute non-source (e.g., minimized or compacted) forms of
that code without the copy of the GNU GPL normally required by
section 4, provided you include this license notice and a URL
through which recipients can access the Corresponding Source.


@licend  The above is the entire license notice
for the JavaScript code in this tag.
*/
<!--/*--><![CDATA[/*><!--*/
 function CodeHighlightOn(elem, id)
 {
   var target = document.getElementById(id);
   if(null != target) {
     elem.cacheClassElem = elem.className;
     elem.cacheClassTarget = target.className;
     target.className = "code-highlighted";
     elem.className   = "code-highlighted";
   }
 }
 function CodeHighlightOff(elem, id)
 {
   var target = document.getElementById(id);
   if(elem.cacheClassElem)
     elem.className = elem.cacheClassElem;
   if(elem.cacheClassTarget)
     target.className = elem.cacheClassTarget;
 }
/*]]>*///-->
</script>
<script type="text/javascript" src="http://orgmode.org/mathjax/MathJax.js"></script>
<script type="text/javascript">
<!--/*--><![CDATA[/*><!--*/
    MathJax.Hub.Config({
        // Only one of the two following lines, depending on user settings
        // First allows browser-native MathML display, second forces HTML/CSS
        //  config: ["MMLorHTML.js"], jax: ["input/TeX"],
            jax: ["input/TeX", "output/HTML-CSS"],
        extensions: ["tex2jax.js","TeX/AMSmath.js","TeX/AMSsymbols.js",
                     "TeX/noUndefined.js"],
        tex2jax: {
            inlineMath: [ ["\\(","\\)"] ],
            displayMath: [ ['$$','$$'], ["\\[","\\]"], ["\\begin{displaymath}","\\end{displaymath}"] ],
            skipTags: ["script","noscript","style","textarea","pre","code"],
            ignoreClass: "tex2jax_ignore",
            processEscapes: false,
            processEnvironments: true,
            preview: "TeX"
        },
        showProcessingMessages: true,
        displayAlign: "center",
        displayIndent: "2em",

        "HTML-CSS": {
             scale: 100,
             availableFonts: ["STIX","TeX"],
             preferredFont: "TeX",
             webFont: "TeX",
             imageFont: "TeX",
             showMathMenu: true,
        },
        MMLorHTML: {
             prefer: {
                 MSIE:    "MML",
                 Firefox: "MML",
                 Opera:   "HTML",
                 other:   "HTML"
             }
        }
    });
/*]]>*///-->
</script>
</head>
<body>
<div id="content">
<h1 class="title">Week 4 lecture notes - PSYC 5316</h1>
<p>
Let's begin with an example.  A researcher claims that on a test of open-mindedness, the population mean for adult men is at least 50.  As a check on this claim, imagine that 10 adult males are randomly sampled and their scores on the measure are:
</p>

<pre class="example">
scores = c(25, 60, 43, 56, 32, 43, 47, 59, 39, 41)
</pre>

<p>
A quick computation (<code>mean(scores)</code>) shows that \(\overline{x}=44.5\).  Does this make the claim that \(\mu \geq 50\) unreasonable?
</p>

<p>
Note that we can address this question using confidence intervals.  To construct a 95% confidence interval, we compute the following:
</p>

<p>
\[
\overline{x}-c\frac{s}{\sqrt{n}}, \overline{x}+c\frac{s}{\sqrt{n}}
\]
</p>

<p>
The relevant R commands for this problem would be:
</p>

<pre class="example">
xbar = mean(scores)
s = sd(scores)
n=length(scores)
c = qt(0.975,df=n-1)
</pre>

<p>
Thus, we can easily compute the confidence interval as:
</p>

<pre class="example">
xbar - c*s/sqrt(n) # lower limit
xbar + c*s/sqrt(n) # upper limit
</pre>

<p>
Hence, we are 95% confident that the true population mean \(\mu\) is somewhere between 36.3 and 52.7.  As a result, it is not unreasonable to believe \(\mu\geq 50\).
</p>

<p>
Confidence intervals can be used to test hypotheses in this way.  However, there is a different way that is a bit more common in the behavioral sciences.  The method we will describe today was originally developed by Neyman and Pearson in 1933.
</p>

<div id="outline-container-sec-1" class="outline-2">
<h2 id="sec-1">Hypothesis Testing (Neyman-Pearson)</h2>
<div class="outline-text-2" id="text-1">
<p>
The goal in NP hypothesis testing is to find a <i>decision rule</i> about whether to accept or reject a <b>null hypothesis</b>.  If one decides to reject the null hypothesis, the researcher concludes that the <b>alternative hypothesis</b> is accepted.
</p>

<p>
Example: in the preceding example, our null hypothesis would be \(H_0:\mu<50\), and our alternative hypothesis would be \(H_1:\mu\geq 50\).  
</p>

<ul class="org-ul">
<li>note: the null hypothesis \(H_0\) is typically set to be the <b>opposite</b> of what you predict.
</li>
</ul>

<p>
Since NP hypothesis testing involves making a decision, there is always a possibility of making an error.
</p>

<p>
Definition: A <b>Type I error</b> occurs when we reject a true null hypothesis.  The probability of making a Type I error is \(\alpha\), which we often call the <i>level of significance</i>.
</p>

<p>
Now, we are in a position to define exactly how NP hypothesis testing works.
</p>
</div>

<div id="outline-container-sec-1-1" class="outline-3">
<h3 id="sec-1-1">The NP Hypothesis Test</h3>
<div class="outline-text-3" id="text-1-1">
<p>
Let \(\mu_0\) be some specified value and consider the goal of testing \(H_0:\mu\geq \mu_0\) such that the Type I error probability is \(\alpha\).  Then we compute:
</p>

<p>
\[
z=\frac{\overline{x}-\mu_0}{\sigma / \sqrt{n}}
\]
</p>

<p>
<i>Decision rule</i>:  we <b>reject</b> the null hypothesis \(H_0\) if \(z\leq c\), where \(c\) is the \(\alpha\) quantile of the standard normal distribution.
</p>
</div>
</div>

<div id="outline-container-sec-1-2" class="outline-3">
<h3 id="sec-1-2">Example 1</h3>
<div class="outline-text-3" id="text-1-2">
<p>
Let's perform an NP hypothesis test on the data above.  Suppose that we know that the population standard deviation is \(\sigma=12\). 
</p>

<ul class="org-ul">
<li>Step 1 &#x2013; set \(H_0: \mu\geq 50\) (so \(\mu_0=50\)).
</li>
<li>Step 2 &#x2013; set \(\alpha=0.05\) (this is pretty common) 
</li>
<li>Step 3 &#x2013; compute \(z\):
</li>
</ul>

<p>
\[
z=\frac{\overline{x}-\mu_0}{\sigma / \sqrt{n}} = \frac{44.5-50}{12 / \sqrt{10}} = -1.45
\]
</p>

<ul class="org-ul">
<li>Step 4 &#x2013; compute \(c\) (this is often called the "critical value")
</li>
</ul>

<pre class="example">
qnorm(0.05)
#+BEGIN_SRC

  - Step 5 -- compare $z$ to $c=-1.645$.  Because $z=-1.45$ is greater than $c=-1.645$, we fail to reject $H_0$ and conclude that $\mu \geq 50$.

These steps are a little easier to digest if we can visualize how everything fits together graphically.  Fortunately, this is not too hard to accomplish in R.

#+BEGIN_SRC
shadedTails &lt;- function(from, to, density, ..., col="red"){
  y_seq = seq(from, to, length.out=500)
  d = c(0, density(y_seq, ...), 0)
  polygon(c(from, y_seq, to), d, col=col, density=50)
}
  
x=seq(-4,4,0.01)
plot(x,dnorm(x),type="l",xlab="z-score")
shadedTails(-4, -1.645, dnorm)
points(x=-1.45, y=0.01, lwd=2)
</pre>

<p>
The first bit of code defines a convenient function for us to use for the remainder of the lecture.  The second bit produces a plot with a red shaded region and a circle.  The red region is the "rejection region", and the circle represents our sample.  Notice that the sample is outside the rejection region, which tells us that we don't reject the null hypothesis.
</p>


<div class="figure">
<p><img src="figures/week4/rejectionRegion.png" alt="rejectionRegion.png" />
</p>
</div>
</div>
</div>

<div id="outline-container-sec-1-3" class="outline-3">
<h3 id="sec-1-3">Example 2</h3>
<div class="outline-text-3" id="text-1-3">
<p>
Suppose SAT math scores are normally distributed with \(\mu=580\) and \(\sigma=50\).  You have developed a new training course and want to empirically determine its efficacy.  Your sample of 20 students attains an average score of 610.  Is this a significant increase?
</p>

<ul class="org-ul">
<li>Step 1 &#x2013; set \(H_0: \mu \leq 580\) (we hypothesize an increase, so our null is opposite of this; a decrease)
</li>
<li>Step 2 &#x2013; set \(\alpha=0.01\) (we want to be really sure!) 
</li>
<li>Step 3 &#x2013; compute \(z\):
</li>
</ul>

<p>
\[
z=\frac{\overline{x}-\mu_0}{\sigma / \sqrt{n}} = \frac{610-580}{50 / \sqrt{20}} = 2.68
\]
</p>

<ul class="org-ul">
<li>Step 4 &#x2013; compute \(c\) (this is often called the "critical value")
</li>
</ul>

<pre class="example">
qnorm(0.99) # this is because we want to be in upper 1%
</pre>

<ul class="org-ul">
<li>Step 5 &#x2013; compare \(z\) to \(c=2.33\).  Because \(z=2.68\) is greater than \(c=2.33\), we reject \(H_0\) and conclude that \(\mu \geq 580\).
</li>
</ul>

<p>
The visualization of this hypothesis test is as follows:
</p>

<pre class="example">
x=seq(-4,4,0.01)
plot(x,dnorm(x),type="l",xlab="z-score")
shadedTails(2.33, 4, dnorm)
points(x=2.68, y=0.01, lwd=2)
</pre>


<div class="figure">
<p><img src="figures/week4/example2.png" alt="example2.png" />
</p>
</div>
</div>
</div>
</div>
</div>
<div id="postamble" class="status">
<p class="date">Date: September 18, 2017</p>
<p class="date">Created: 2017-09-15 Fri 10:29</p>
<p class="creator"><a href="http://www.gnu.org/software/emacs/">Emacs</a> 25.2.1 (<a href="http://orgmode.org">Org</a> mode 8.2.10)</p>
<p class="validation"><a href="http://validator.w3.org/check?uri=referer">Validate</a></p>
</div>
</body>
</html>
