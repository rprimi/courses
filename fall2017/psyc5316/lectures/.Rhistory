N = 5000
Xbar=rep(0,N)
for (i in 1:N){
Xsamp=rnorm(n=25, mean=50, sd=25)
Xbar[i]=mean(Xsamp)
}
par(mfrow=c(2,1))
par(mfrow=c(2,1))
plot(density(x))
plot(density(Xbar))
x=seq(30,70,0.01)
plot(x,dnorm(x, mean=50, sd=25))
plot(x,dnorm(x, mean=50, sd=25), type="l")
x=seq(-50,150,0.1)
plot(x,dnorm(x, mean=50, sd=25), type="l")
par(mfrow=c(2,1))
x=seq(-50,150,0.1)
plot(x,dnorm(x, mean=50, sd=25), type="l")
plot(density(Xbar),xlim=c(-50,150))
mean(Xbar)
sd(Xbar)
pnorm(11, mean=14, sd=1.279)
pnorm(-2.35)
(11-14)/(6/sqrt(22))
pnorm(-2.345)
pnorm(1.96)-pnorm(-1.96)
pnorm(1.645)-pnorm(-1.645)
qnorm(0.0.5)
qnorm(0.5)
qnorm(0.05)
?dt
x=seq(-3,3,0.01)
plot(x,dt(x,df=5),type="l")
plot(x,dnorm(x),type="l")
dev.off()
x=seq(-3,3,0.01)
plot(x,dnorm(x),type="l")
lines(x,dt(x,df=5),lty=2)
lines(x,dt(x,df=20),lty=3)
?legend
lines(x,dt(x,df=3),lty=2)
lines(x,dt(x,df=5),lty=2)
dev.off()
x=seq(-3,3,0.01)
plot(x,dnorm(x),type="l")
lines(x,dt(x,df=5),lty=2)
lines(x,dt(x,df=20),lty=3)
legend(0,0.1,c("normal"))
legend(0,0.1,c("normal"),lty=1:3)
legend(0,0.1,c("normal","df=5","df=20"),lty=1:3)
qt(0.025, df=21)
qt(0.975, df=21)
qt(0.05, df=21)
qt(0.95, df=21)
11-1.72*19/sqrt{22}
11-1.72*19/sqrt(22)
11+1.72*19/sqrt(22)
read=c(12,20,34,45,34,36,37,50,11,32,29)
mean(read)
sd(read)
Xbar=mean(read)
s=sd(read)
length(read)
c=qt(0.975,df=10)
Xbar-c*s/sqrt(10)
Xbar+c*s/sqrt(10) # upper limit
N=5000
Xbar=rep(0,N)
for (i in 1:N){
Xsamp=runif(n=20, min=0, max=1)
Xbar[i]=mean(Xsamp)
}
par(mfrow=c(2,1))
x=seq(0,1,0.01)
plot(x, dunif(x, min=0, max=1), type="l")
plot(density(Xbar))
N=5000
Xbar=rep(0,N)
for (i in 1:N){
Xsamp=rexp(n=20, rate=1)
Xbar[i]=mean(Xsamp)
}
x=seq(0,1,0.01)
plot(x, dexp(x, rate=1), type="l")
plot(density(Xbar))
rcnorm <- function(n,mean,sd1,sd2,prob){
x0 = rnorm(n, mean, sd=sd1)
x1 = rnorm(n, mean, sd=sd2)
flag = rbinom(n, size=1, prob)
return(x0*(1-flag) + x1*flag)
}
N=5000
T=rep(0,N)
for (i in 1:N){
samp=rcnorm(n=20, mean=50, sd1=3, sd2=10, prob=0.5)
T[i]=(mean(samp)-50)/(sd(samp)/sqrt(20))
}
x=seq(-4,4,0.01)
plot(density(T))
lines(x,dt(x,df=19),lty=2) # looks pretty similar, right?
qt(c(0.025,0.975),df=19)
sum(T>-2.09 & T<2.09)/5000
N=5000
Xbar=rep(0,N)
for (i in 1:N){
Xsamp=runif(n=20, min=0, max=1)
Xbar[i]=mean(Xsamp)
}
par(mfrow=c(2,1))
x=seq(0,1,0.01)
plot(x, dunif(x, min=0, max=1), type="l")
plot(density(Xbar))
N=5000
Xbar=rep(0,N)
for (i in 1:N){
Xsamp=rexp(n=20, rate=1)
Xbar[i]=mean(Xsamp)
}
x=seq(0,1,0.01)
plot(x, dexp(x, rate=1), type="l")
plot(density(Xbar))
N=5000
T=rep(0,N)
for (i in 1:N){
samp=rcnorm(n=20, mean=50, sd1=3, sd2=10, prob=0.5)
T[i]=(mean(samp)-50)/(sd(samp)/sqrt(20))
}
x=seq(-4,4,0.01)
plot(density(T))
lines(x,dt(x,df=19),lty=2) # looks pretty similar, right?
dev.off()
N=5000
T=rep(0,N)
for (i in 1:N){
samp=rcnorm(n=20, mean=50, sd1=3, sd2=10, prob=0.5)
T[i]=(mean(samp)-50)/(sd(samp)/sqrt(20))
}
x=seq(-4,4,0.01)
plot(density(T))
lines(x,dt(x,df=19),lty=2) # looks pretty similar, right?
qt(c(0.025,0.975),df=19)
sum(T>-2.09 & T<2.09)/5000
par(mfrow=c(2,1))
plot(density(T))
x=seq(0,20,0.01)
plot(x,dlnorm(x,meanlog=location,sdlog=shape),type="l")
m <- 50
s <- 10
location <- log(m^2 / sqrt(s^2 + m^2))
shape <- sqrt(log(1 + (s^2 / m^2)))
par(mfrow=c(2,1))
x=seq(0,20,0.01)
plot(x,dlnorm(x,meanlog=location,sdlog=shape),type="l")
x=seq(0,100,0.01)
plot(x,dlnorm(x,meanlog=location,sdlog=shape),type="l")
m <- 20
s <- 10
location <- log(m^2 / sqrt(s^2 + m^2))
shape <- sqrt(log(1 + (s^2 / m^2)))
N=5000
T=rep(0,N)
for (i in 1:N){
samp=rlnorm(n=20, meanlog=location, sdlog=shape)
T[i]=(mean(samp)-50)/(sd(samp)/sqrt(20))
}
m <- 20
s <- 10
location <- log(m^2 / sqrt(s^2 + m^2))
shape <- sqrt(log(1 + (s^2 / m^2)))
N=5000
T=rep(0,N)
for (i in 1:N){
samp=rlnorm(n=20, meanlog=location, sdlog=shape)
T[i]=(mean(samp)-m)/(sd(samp)/sqrt(20))
}
par(mfrow=c(2,1))
x=seq(0,100,0.01)
plot(x,dlnorm(x,meanlog=location,sdlog=shape),type="l")
par(mfrow=c(2,1))
x=seq(0,50,0.01)
plot(x,dlnorm(x,meanlog=location,sdlog=shape),type="l")
plot(density(T))
quantile(T,probs=c(0.025, 0.975))
sum(T>-2.09 & T<2.09)/5000
N=5000
T=rep(0,N)
for (i in 1:N){
samp=rlnorm(n=200, meanlog=location, sdlog=shape)
T[i]=(mean(samp)-50)/(sd(samp)/sqrt(200))
}
x=seq(0,50,0.01)
plot(x,dlnorm(x,meanlog=location,sdlog=shape),type="l")
plot(density(T))
N=5000
T=rep(0,N)
for (i in 1:N){
samp=rlnorm(n=200, meanlog=location, sdlog=shape)
T[i]=(mean(samp)-m)/(sd(samp)/sqrt(200))
}
x=seq(0,50,0.01)
plot(x,dlnorm(x,meanlog=location,sdlog=shape),type="l")
plot(density(T))
quantile(T, probs=c(0.025, 0.975))
sum(T>-2.09 & T<2.09)/5000
val=0
rbinom(20,6,0.9)
rbinom(25,6,0.9)
for (i in 1:5000){val[i]=median(rbinom(25,6,0.9))}
splot
hist(val)
plot(density(val))
(54-50)/(12/sqrt(16))
qnorm(0.975)
x=seq(-4,4,0.01)
plot(x,dnorm(x),type="l",xlab="z-score")
shadedTails(-4, -1.96, dnorm)
shadedTails(1.96, 4, dnorm)
shadedTails <- function(from, to, density, ..., col="red"){
y_seq = seq(from, to, length.out=500)
d = c(0, density(y_seq, ...), 0)
polygon(c(from, y_seq, to), d, col=col, density=50)
}
x=seq(-4,4,0.01)
plot(x,dnorm(x),type="l",xlab="z-score")
shadedTails(-4, -1.96, dnorm)
shadedTails(1.96, 4, dnorm)
points(x=1.33, y=0.01, lwd=2)
x=seq(-4,4,0.01)
plot(x,dnorm(x),type="l",xlab="z-score")
shadedTails(-4, -0.53, dnorm)
qnorm(-0.53)
qnorm(-0.53)
pnorm(-0.53)
x=seq(-4,4,0.01)
plot(x,dnorm(x),type="l",xlab="z-score")
shadedTails(-4, -2.67, dnorm)
shadedTails(2.67, 4, dnorm)
pnorm(-2.67)+(1-pnorm(2.67))
x=seq(-4,4,0.01)
plot(x,dnorm(x),type="l",xlab="z-score")
x=seq(-4,6,0.01)
plot(x,dnorm(x),type="l",xlab="z-score")
shadedTails(1.645,6,dnorm)
(55-50)/(10/sqrt(30))
lines(x,dnorm(x,mean=2.74,sd=1),lty=2)
abline(v=2.74)
abline(v=1.645)
x=seq(-4,6,0.01)
plot(x,dnorm(x),type="l",xlab="z-score")
shadedTails(1.645,6,dnorm)
lines(x,dnorm(x,mean=2.74,sd=1),lty=2)
abline(v=1.645)
text(-2,0.2,"H0 true")
shadedTails(1.645,6,dnorm)
lines(x,dnorm(x,mean=2.74,sd=1),lty=2)
x=seq(-4,6,0.01)
plot(x,dnorm(x),type="l",xlab="z-score")
text(-2,0.2,"H0 true")
shadedTails(1.645,6,dnorm)
lines(x,dnorm(x,mean=2.74,sd=1),lty=2)
text(5,0.2,"H0 false")
abiline(v=1.645)
abline(v=1.645)
50+1.645(10)
50+1.645*10
50+1.645*10/sqrt(30)
(53-55)/(10/sqrt(30))
1-p(-1.095)
1-pnorm(-1.095)
x=seq(-4,6,0.01)
plot(x,dnorm(x),type="l",xlab="z-score")
text(-2,0.2,"H0 true")
shadedTails(-4,-1.96,dnorm)
shadedTails(1.96,6,dnorm)
lines(x,dnorm(x,mean=2.74,sd=1),lty=2)
text(5,0.2,"H0 false")
50+1.96*10
50+1.96*10/sqrt(30)
50-1.96*10/sqrt(30)
(53.58-55)/(10/sqrt(30))
(46.42-55)/(10/sqrt(30))
pnorm(-0.78)
1-pnorm(-0.78)
pnorm(-4.70)
N = 100
x = runif(N)
y = 3 + 5*x + rnorm(N)
plot(x, y, ylim=c(0,10))
model1 = lm(y~x)
summary(model1)
abs = function(data,par){
with(data, sum(abs(y-(par[1]+par[2]*x)))
}
dat=data.frame(x,y)
inits=c(1,1)
optim(inits, SS, data=dat)
abs = function(data,par){
with(data, sum(abs(y-(par[1]+par[2]*x)))
}
dat=data.frame(x,y)
inits=c(1,1)
optim(inits, SS, data=dat)
abs = function(data,par){
with(data, sum(abs(y-(par[1]+par[2]*x))))
}
optim(inits, abs, data=dat)
dat=data.frame(x,y)
inits=c(1,1)
optim(inits, abs, data=dat)
abs
?abs
L1 = function(data,par){
with(data, sum(abs(y-(par[1]+par[2]*x))))
}
dat=data.frame(x,y)
inits=c(1,1)
optim(inits, abs, data=dat)
N = 100
x = runif(N)
y = 3 + 5*x + rnorm(N)
plot(x, y, ylim=c(0,10))
model1 = lm(y~x)
summary(model1)
L1 = function(data,par){
with(data, sum(abs(y-(par[1]+par[2]*x))))
}
dat=data.frame(x,y)
inits=c(1,1)
optim(inits, abs, data=dat)
optim(inits, L1, data=dat)
reg.nll = function(data, par){
residual = with(data, y-(par[1]+par[2]*x))
return(sum(-log(dnorm(residual, mean=0, sd=par[3]))))
}
inits=c(1,1,1)
optim(inits, reg.nll, data=dat)
fit = optim(inits, reg.nll, data=dat, hessian = TRUE)
hessian = fit$hessian
inverse = solve(hessian)
se = sqrt(diag(inverse))
se
y=rnorm(10, sd=1:10)
plot(y)
N = 100
x = 1:N
y = 3 + 5*x + rnorm(N, mean=0, sd=rep(1,10):rep(10:10))
x/100
x/10
ceiling(x/10)
y = 3 + 5*x + rnorm(N, mean=0, sd=ceiling(x/10))
plot(x, y, ylim=c(0,10))
plot(x, y, ylim=c(0,1000))
plot(x, y, ylim=c(0,600))
x = seq(1,10,length=100)
y = 3 + 5*x + rnorm(N, mean=0, sd=ceiling(x/10))
plot(x, y, ylim=c(0,600))
plot(x, y, ylim=c(0,60))
y = 3 + 5*x + rnorm(N, mean=0, sd=ceiling(x))
plot(x, y, ylim=c(0,60))
model1 = lm(y~x)
summary(model1)
intercept = model1$coefficients[1]
slope = model1$coefficients[2]
abline(a=intercept, b=slope)
plot(density(model1$residuals))
plot(model1$residuals)
N = 100
x = seq(1,10,length=100)
y = 3 + 5*x + rnorm(N)
plot(x, y, ylim=c(0,60))
y = 3 + 5*x + rnorm(N, mean=0, sd=5)
plot(x, y, ylim=c(0,60))
model1 = lm(y~x)
summary(model1)
intercept = model1$coefficients[1]
slope = model1$coefficients[2]
abline(a=intercept, b=slope)
plot(model1$residuals)
N = 100
x = seq(1,10,length=100)
y = 3 + 5*x + rnorm(N, mean=0, sd=ceiling(x))
plot(x, y, ylim=c(0,60))
model1 = lm(y~x)
model2 = lm(y~x)
summary(model1)
summary(model2)
intercept = model2$coefficients[1]
slope = model2$coefficients[2]
plot(model2$residuals))
plot(model2$residuals)
x=c(1,4,2,19,4,12,29,4,9,16)
bootstrapSample = sample(x, size=10, replace=TRUE)
bootstrapSample
sd(bootstrapSample)
mean(bootstrapSample)
xBar = mean(x)
tStar = (mean(bootstrapSample)-xBar)/(sd(bootstrapSample)/sqrt{10})
tStar = (mean(bootstrapSample)-xBar)/(sd(bootstrapSample)/sqrt(10))
B=100
tStar = numeric(B)
for (i in 1:B){
bootstrapSample = sample(x, size=10, replace=TRUE)
mean(bootstrapSample)
sd(bootstrapSample)
tStar[i] = (mean(bootstrapSample)-xBar)/(sd(bootstrapSample)/sqrt(10))
}
hist(tStar)
quantile(tStar,probs = c(0.025, 0.975))
quantile(tStar, probs=c(0.025, 0.975))
lower=quantile(tStar, 0.025)
upper=quantile(tStar, 0.975)
s=sd(x)
xBar-lowerT*s/sqrt(n)
lowerT=quantile(tStar, 0.025)
upperT=quantile(tStar, 0.975)
xBar-lowerT*s/sqrt(n)
n=length(x)
for (i in 1:B){
bootstrapSample = sample(x, size=n, replace=TRUE)
mean(bootstrapSample)
sd(bootstrapSample)
tStar[i] = (mean(bootstrapSample)-xBar)/(sd(bootstrapSample)/sqrt(10))
}
lowerT=quantile(tStar, 0.025)
upperT=quantile(tStar, 0.975)
xBar-lowerT*s/sqrt(n)
xBar+lowerT*s/sqrt(n)
xBar+upperT*s/sqrt(n)
B=1000
tStar = numeric(B)
for (i in 1:B){
bootstrapSample = sample(x, size=n, replace=TRUE)
mean(bootstrapSample)
sd(bootstrapSample)
tStar[i] = (mean(bootstrapSample)-xBar)/(sd(bootstrapSample)/sqrt(10))
}
lowerT = quantile(tStar, 0.025)
upperT = quantile(tStar, 0.975)
xBar+lowerT*s/sqrt(n)
xBar+upperT*s/sqrt(n)
install.packages(c("MASS", "akima", "robustbase"))
install.packages(c("cobs", "robust", "mgcv", "scatterplot3d", "quantreg", "rrcov", "lars", "pwr", "trimcluster", "mc2d", "psych", "Rfit", "DepthProc", "class", "fda", "parallel"))
library(devtools)
install_github("mrxiaohe/WRScpp")
install_github("nicebread/WRS", subdir="pkg")
library(WRS)
onesampb(x)
x
onesampb(x,est=mean())
onesampb(x,est=mean(x))
onesampb(x,est=mean)
B=2000
tStar = numeric(B)
for (i in 1:B){
bootstrapSample = sample(x, size=n, replace=TRUE)
mean(bootstrapSample)
sd(bootstrapSample)
tStar[i] = (mean(bootstrapSample)-xBar)/(sd(bootstrapSample)/sqrt(10))
}
lowerT = quantile(tStar, 0.025)
upperT = quantile(tStar, 0.975)
xBar+lowerT*s/sqrt(n)
xBar+upperT*s/sqrt(n)
plot(tStar)
hist(tStar)
B=2000
tStar = numeric(B)
for (i in 1:B){
bootstrapSample = sample(x, size=n, replace=TRUE)
mean(bootstrapSample)
sd(bootstrapSample)
tStar[i] = (mean(bootstrapSample)-xBar)/(sd(bootstrapSample)/sqrt(n))
}
lowerT = quantile(tStar, 0.025)
upperT = quantile(tStar, 0.975)
xBar+lowerT*s/sqrt(n)
xBar+upperT*s/sqrt(n)
boot = matrix(sample(x, size=length(x)*B, replace=TRUE), nrow=B)
boot
means = apply(boot, 1, mean)
means
hist(means)
means = sort(means)
means
lower = round(0.05/2*B)
50/2000
upper = B-lower
means[lower]
means[upper]
lowerIndex = round(0.05/2*B)
upperIndex = B-lower
means[lowerIndex] # lower bound
means[upperIndex] # upper bound
bootSamples = matrix(sample(x, size=length(x)*B, replace=TRUE), nrow=B)
means = apply(bootSamples, 1, mean)
means = sort(means)
lowerIndex = round(0.05/2*B)
upperIndex = B-lower
means[lowerIndex] # lower bound
means[upperIndex] # upper bound
