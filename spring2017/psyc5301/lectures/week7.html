<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en">
<head>
<title>Week 7 lecture notes - PSYC 5301</title>
<!-- 2017-02-28 Tue 14:30 -->
<meta  http-equiv="Content-Type" content="text/html;charset=utf-8" />
<meta  name="generator" content="Org-mode" />
<style type="text/css">
 <!--/*--><![CDATA[/*><!--*/
  .title  { text-align: center; }
  .todo   { font-family: monospace; color: red; }
  .done   { color: green; }
  .tag    { background-color: #eee; font-family: monospace;
            padding: 2px; font-size: 80%; font-weight: normal; }
  .timestamp { color: #bebebe; }
  .timestamp-kwd { color: #5f9ea0; }
  .right  { margin-left: auto; margin-right: 0px;  text-align: right; }
  .left   { margin-left: 0px;  margin-right: auto; text-align: left; }
  .center { margin-left: auto; margin-right: auto; text-align: center; }
  .underline { text-decoration: underline; }
  #postamble p, #preamble p { font-size: 90%; margin: .2em; }
  p.verse { margin-left: 3%; }
  pre {
    border: 1px solid #ccc;
    box-shadow: 3px 3px 3px #eee;
    padding: 8pt;
    font-family: monospace;
    overflow: auto;
    margin: 1.2em;
  }
  pre.src {
    position: relative;
    overflow: visible;
    padding-top: 1.2em;
  }
  pre.src:before {
    display: none;
    position: absolute;
    background-color: white;
    top: -10px;
    right: 10px;
    padding: 3px;
    border: 1px solid black;
  }
  pre.src:hover:before { display: inline;}
  pre.src-sh:before    { content: 'sh'; }
  pre.src-bash:before  { content: 'sh'; }
  pre.src-emacs-lisp:before { content: 'Emacs Lisp'; }
  pre.src-R:before     { content: 'R'; }
  pre.src-perl:before  { content: 'Perl'; }
  pre.src-java:before  { content: 'Java'; }
  pre.src-sql:before   { content: 'SQL'; }

  table { border-collapse:collapse; }
  caption.t-above { caption-side: top; }
  caption.t-bottom { caption-side: bottom; }
  td, th { vertical-align:top;  }
  th.right  { text-align: center;  }
  th.left   { text-align: center;   }
  th.center { text-align: center; }
  td.right  { text-align: right;  }
  td.left   { text-align: left;   }
  td.center { text-align: center; }
  dt { font-weight: bold; }
  .footpara:nth-child(2) { display: inline; }
  .footpara { display: block; }
  .footdef  { margin-bottom: 1em; }
  .figure { padding: 1em; }
  .figure p { text-align: center; }
  .inlinetask {
    padding: 10px;
    border: 2px solid gray;
    margin: 10px;
    background: #ffffcc;
  }
  #org-div-home-and-up
   { text-align: right; font-size: 70%; white-space: nowrap; }
  textarea { overflow-x: auto; }
  .linenr { font-size: smaller }
  .code-highlighted { background-color: #ffff00; }
  .org-info-js_info-navigation { border-style: none; }
  #org-info-js_console-label
    { font-size: 10px; font-weight: bold; white-space: nowrap; }
  .org-info-js_search-highlight
    { background-color: #ffff00; color: #000000; font-weight: bold; }
  /*]]>*/-->
</style>
<script type="text/javascript">
/*
@licstart  The following is the entire license notice for the
JavaScript code in this tag.

Copyright (C) 2012-2013 Free Software Foundation, Inc.

The JavaScript code in this tag is free software: you can
redistribute it and/or modify it under the terms of the GNU
General Public License (GNU GPL) as published by the Free Software
Foundation, either version 3 of the License, or (at your option)
any later version.  The code is distributed WITHOUT ANY WARRANTY;
without even the implied warranty of MERCHANTABILITY or FITNESS
FOR A PARTICULAR PURPOSE.  See the GNU GPL for more details.

As additional permission under GNU GPL version 3 section 7, you
may distribute non-source (e.g., minimized or compacted) forms of
that code without the copy of the GNU GPL normally required by
section 4, provided you include this license notice and a URL
through which recipients can access the Corresponding Source.


@licend  The above is the entire license notice
for the JavaScript code in this tag.
*/
<!--/*--><![CDATA[/*><!--*/
 function CodeHighlightOn(elem, id)
 {
   var target = document.getElementById(id);
   if(null != target) {
     elem.cacheClassElem = elem.className;
     elem.cacheClassTarget = target.className;
     target.className = "code-highlighted";
     elem.className   = "code-highlighted";
   }
 }
 function CodeHighlightOff(elem, id)
 {
   var target = document.getElementById(id);
   if(elem.cacheClassElem)
     elem.className = elem.cacheClassElem;
   if(elem.cacheClassTarget)
     target.className = elem.cacheClassTarget;
 }
/*]]>*///-->
</script>
</head>
<body>
<div id="content">
<h1 class="title">Week 7 lecture notes - PSYC 5301</h1>
<div id="outline-container-sec-1" class="outline-2">
<h2 id="sec-1">Review of Questions from Week 6</h2>
<div class="outline-text-2" id="text-1">
</div><div id="outline-container-sec-1-1" class="outline-3">
<h3 id="sec-1-1">Why is randomization necessary in order to infer a causal relationship from an experiment?</h3>
<div class="outline-text-3" id="text-1-1">
<p>
Student responses:
</p>
<ul class="org-ul">
<li>(CB) prevents individual differences from being "unequally skewed"
</li>
<li>(KL) eliminates differences between individuals in a sample
</li>
<li>(MD) isolates confounds
</li>
<li>(JH) eliminates bias (what kind of bias)?
</li>
<li>(HH) reduce unknown variables from influencing outcomes
</li>
<li>(DU) differences between groups are likely due to experiment procedures
</li>
<li>(SH) participants have equal chance of being assigned to a group
</li>
<li>(KS) varies types of people in each condition
</li>
<li>(MR) removes the need for control of individual differences
</li>
</ul>
</div>

<div id="outline-container-sec-1-1-1" class="outline-4">
<h4 id="sec-1-1-1">Confounds: a class demo</h4>
<div class="outline-text-4" id="text-1-1-1">
<ol class="org-ol">
<li>divide room into two groups (male and female is best)
</li>
<li>Females given Stroop task with no interference&#x2026;measure time
</li>
<li>Males given Stroop task with interference&#x2026;measure time
</li>
<li>Who wins?  Does that mean males/females have better attentional focus?
</li>
</ol>


<div class="figure">
<p><img src="figures/compare.jpg" alt="compare.jpg" />
</p>
</div>

<p>
The problem with our inference in this experiment is that one variable (color/word interference) is perfectly correlated with another (gender).  This is called a <i>confound</i>, and it is a threat to internal validity.
</p>

<p>
The goal in any experimental design is to minimize confounds.
</p>

<p>
Types of confounds (and solutions):
</p>
<ul class="org-ul">
<li>Group differences (solution: use random assignment)
</li>
<li>Order/testing effects (solution: use counterbalancing)
</li>
<li>experimenter bias (solution: use blinding)
</li>
</ul>
</div>
</div>

<div id="outline-container-sec-1-1-2" class="outline-4">
<h4 id="sec-1-1-2">Aside: does randomization REALLY remove individual differences?</h4>
<div class="outline-text-4" id="text-1-1-2">
<p>
R demo: open <code>residenceData.R</code>  
</p>

<p>
This script loads a data file of 26 individuals measured on various characteristics (e.g., age, # hours work per week).
</p>

<p>
The script does the following:
</p>
<ul class="org-ul">
<li>randomly select half of the individuals and assign them to Group A
</li>
<li>other half is assigned to Group B
</li>
<li>Age and Work are supposed to be <i>individual differences</i>.  Random assignment to Groups A and B <i>should</i> remove the individual differences..that is, Groups A and B should be <i>equivalent</i> with respect to Age and Work
</li>
<li>test this claim via an independent samples t-test..what do we see?
</li>
<li>let's simulate this process 10,000 times.  How often are the two groups equivalent?  How often are they different?
</li>
</ul>


<div class="figure">
<p><img src="figures/ageWorkPvalues.png" alt="ageWorkPvalues.png" /> 
</p>
</div>
</div>
</div>
</div>


<div id="outline-container-sec-1-2" class="outline-3">
<h3 id="sec-1-2">You report p=0.045 with a high powered experiment.  One of your committee members counters that your obtained p-value actually lends more evidence for the null than the alternative.  How do you respond?</h3>
<div class="outline-text-3" id="text-1-2">
<p>
Student responses:
</p>
<ul class="org-ul">
<li>5 agreed
<ul class="org-ul">
<li>3 expected smaller p-value
</li>
<li>1 expected smaller p-value, but supported "decision" to reject
</li>
<li>1 said 95% power &#x2013;&gt; should expect large effect
</li>
</ul>
</li>
<li>4 disagreed
<ul class="org-ul">
<li>2 correctly said 5% Type II error rate, but based decision to reject on this (incorrect)
</li>
<li>1 said "p &lt; 0.05, so reject"
</li>
<li>1 said "have confidence that alternative is true" (what does this mean?)
</li>
</ul>
</li>
</ul>

<p>
Let's investigate this!
</p>

<p>
Open <code>pValues-lindley.R</code>.  This is our usual simulation of sampling IQ scores then comparing our sample to hypothesized mean of 100.  Each run of the script generates 100,000 p-values and plots the resulting distribution.
</p>

<p>
Start with M=100.  This simulates H0=true.  What do we noticed about p-value distribution?
<img src="figures/lindley1.png" alt="lindley1.png" />
</p>

<p>
Change M to 107.  This simulates H1=true with a specific effect size.  What do we notice?
<img src="figures/lindley2.png" alt="lindley2.png" />
</p>

<p>
Clearly we have a lot of power.  Let's zoom in a bit on the "significant" p-values (below 0.05).  First, we'll make the following changes:
</p>
<ul class="org-ul">
<li>M=100 (back to H0=true)
</li>
<li>bars = 100
</li>
<li>ylim = c(0,nSims/10)
</li>
</ul>

<p>
This is essentially the same uniform distribution as above, but this time, we have one bar for p-values between 0 and 0.01, 0.01 and 0.02, etc.
<img src="figures/lindley3.png" alt="lindley3.png" />
</p>

<p>
Now, lets zoom in a bit on the "significance zone" between p=0 and p=0.05.  Change xlim to c(0,0.05).  Notice the red horizontal line..this tells us what proportion of p-values we should expect when there is NO effect.
</p>


<div class="figure">
<p><img src="figures/lindley4.png" alt="lindley4.png" />
</p>
</div>

<p>
Let's go back to the situation where we have a lot of power.  Change M to 107. Which p-values are the most frequent?  Which are LEAST frequent?
</p>


<div class="figure">
<p><img src="figures/lindley5.png" alt="lindley5.png" />
</p>
</div>

<p>
Let's get even more power&#x2026;change to M = 109.
</p>


<div class="figure">
<p><img src="figures/lindley6.png" alt="lindley6.png" />
</p>
</div>

<p>
Specifically, look at the p-values between 0.04 and 0.05.  The red line shows how often we can expect them when HO is true.  Notice that we can expect them EVEN LESS OFTEN when H0 is false!
</p>

<p>
Said another way:  p=0.045 is surprising when there is no effect.  p=0.045 is EVEN MORE SURPRSING when there IS an effect!  What???
</p>

<p>
This is known as <i>Lindley's Paradox</i>, and it is an example of when frequentist and Bayesian approaches differ in their conclusions:
</p>
<ul class="org-ul">
<li>frequentist decision: reject H0 (since p&lt;0.05)
</li>
<li>Bayesian decision: accept HO, since p=0.045 is twice as likely under HO as it is under H1.
</li>
</ul>

<p>
Of course, this only seems to happens when power is extremely high (well above 90%).  So what about "marginal" p-values in lower power situations?
</p>

<p>
Open <code>pValues-likelihoods.R</code>.  This script replicates our calculations above 100,000 times, counting the proportion of "marginal" p-values obtained at varying levels of power (ranging from 0.1 to 0.99).  Further, it transforms these proportions to likelihood ratios (alternative to null and null to alternative).
</p>


<div class="figure">
<p><img src="figures/likelihoods.png" alt="likelihoods.png" />
</p>
</div>

<p>
As you can see, the "relative likelihood" of the alternative over the null maxes at 4.  Thus, in the <b>best case scenario</b>, a p-value of 0.045 is only 4 times more likely under H1 than it is under H0.  Is this "evidence" for an effect? 
</p>
</div>
</div>
</div>
</div>
<div id="postamble" class="status">
<p class="date">Date: Feb 28, 2017</p>
<p class="date">Created: 2017-02-28 Tue 14:30</p>
<p class="creator"><a href="http://www.gnu.org/software/emacs/">Emacs</a> 25.1.1 (<a href="http://orgmode.org">Org</a> mode 8.2.10)</p>
<p class="validation"><a href="http://validator.w3.org/check?uri=referer">Validate</a></p>
</div>
</body>
</html>
